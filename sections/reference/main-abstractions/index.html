


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.12">
    
    
      
        <title>Main Abstractions - Baker</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4dd2dd8d.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../css/ing.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#main-abstractions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Baker" class="md-header-nav__button md-logo" aria-label="Baker">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Baker
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Main Abstractions
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ing-bank/baker/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Baker" class="md-nav__button md-logo" aria-label="Baker">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Baker
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ing-bank/baker/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Development Life Cycle
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Development Life Cycle" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Development Life Cycle
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/design-a-recipe/" title="Design a Recipe" class="md-nav__link">
      Design a Recipe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/use-visualizations/" title="Use Visualizations" class="md-nav__link">
      Use Visualizations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/implement-interactions/" title="Implement Interactions" class="md-nav__link">
      Implement Interactions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/bake-fire-events-and-inquiry/" title="Bake, Fire Events and Inquiry" class="md-nav__link">
      Bake, Fire Events and Inquiry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/test/" title="Test" class="md-nav__link">
      Test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/configure/" title="Configure" class="md-nav__link">
      Configure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/monitor/" title="Monitor" class="md-nav__link">
      Monitor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/resolve-failed-recipe-instances/" title="Resolve Failed Recipes" class="md-nav__link">
      Resolve Failed Recipes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Main Abstractions
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Main Abstractions" class="md-nav__link md-nav__link--active">
      Main Abstractions
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#type-and-value" class="md-nav__link">
    Type and Value
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingredient-and-ingredientinstance" class="md-nav__link">
    Ingredient and IngredientInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-and-eventinstance" class="md-nav__link">
    Event and EventInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interaction-and-interactioninstance" class="md-nav__link">
    Interaction and InteractionInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-and-recipeinstance" class="md-nav__link">
    Recipe and RecipeInstance
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../execution-semantics/" title="Execution Semantics" class="md-nav__link">
      Execution Semantics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../baker-types-and-values/" title="Baker Types and Values" class="md-nav__link">
      Baker Types and Values
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dsls/" title="Recipe DSLs" class="md-nav__link">
      Recipe DSLs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../runtime/" title="The Akka Based Runtime" class="md-nav__link">
      The Akka Based Runtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../event-listener/" title="Event Listener" class="md-nav__link">
      Event Listener
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../stores/" title="Event Stores and Cluster Configuration" class="md-nav__link">
      Event Stores and Cluster Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Versions
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Versions" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Versions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../versions/baker-3-release-notes/" title="Release Notes v3" class="md-nav__link">
      Release Notes v3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../versions/baker-3/" title="Migration Guide v3" class="md-nav__link">
      Migration Guide v3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../versions/baker-2/" title="Migration Guide v2" class="md-nav__link">
      Migration Guide v2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../feature-comparison/" title="Feature comparison" class="md-nav__link">
      Feature comparison
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#type-and-value" class="md-nav__link">
    Type and Value
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingredient-and-ingredientinstance" class="md-nav__link">
    Ingredient and IngredientInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-and-eventinstance" class="md-nav__link">
    Event and EventInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interaction-and-interactioninstance" class="md-nav__link">
    Interaction and InteractionInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-and-recipeinstance" class="md-nav__link">
    Recipe and RecipeInstance
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ing-bank/baker/edit/master/docs/sections/reference/main-abstractions.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="main-abstractions">Main Abstractions</h1>
<p>Baker makes a strong division between the specification of your business process and the runtime implementations.</p>
<table>
<thead>
<tr>
<th>Specification</th>
<th>Runtime</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Type</code></td>
<td><code>Value</code></td>
</tr>
<tr>
<td><code>Ingredient</code></td>
<td><code>IngredientInstance</code></td>
</tr>
<tr>
<td><code>Event</code></td>
<td><code>EventInstance</code></td>
</tr>
<tr>
<td><code>Interaction</code></td>
<td><code>InteractionInstance</code></td>
</tr>
<tr>
<td><code>Recipe</code></td>
<td><code>RecipeInstance</code></td>
</tr>
</tbody>
</table>
<p>The first four are used to create <code>Recipe</code>s which serve as "blueprints" of your process. In the Baker
runtime they are used within <code>RecipeInstance</code>s, which are created from a <code>Recipe</code> specification to execute the flow of 
your process.</p>
<h2 id="type-and-value">Type and Value</h2>
<p>Because of the distributed nature of Baker and how the runtime works, we need to have serializable types and values to 
transfer recipes and data between nodes and to match over such data, that is why we implemented a type system on top of Scala.
They help not just to model your domain, but also for Baker to identify when to execute interactions. </p>
<p>If you are using all of our reflection APIs then you will not use them directly, but it is good to know of their 
existence.</p>
<p>Full documentation about the type system can be found <a href="../../reference/baker-types-and-values/">here</a>.</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">com.ing.baker.types._</span>

<span class="k">val</span> <span class="n">data</span><span class="k">:</span> <span class="o">(</span><span class="kt">Type</span><span class="o">,</span> <span class="kt">Value</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="nc">Int32</span><span class="o">,</span> <span class="nc">PrimitiveValue</span><span class="o">(</span><span class="mi">42</span><span class="o">))</span>
</code></pre></div>

</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">com.ing.baker.types.*</span><span class="p">;</span>

<span class="n">Type</span> <span class="n">dataType</span> <span class="o">=</span> <span class="n">Int32$</span><span class="p">.</span><span class="na">MODULE$</span><span class="p">;</span>
<span class="n">Value</span> <span class="n">dataValue</span> <span class="o">=</span> <span class="n">PrimitiveValue</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
</code></pre></div>

</div>
</div>
<h2 id="ingredient-and-ingredientinstance">Ingredient and IngredientInstance</h2>
<p><code>Ingredients</code> are containers for the data in your process. This data is <strong>immutable</strong>, which means that it can only be created and never 
changes in the process. There is <strong>no subtyping</strong>, nor hierarchy. <code>Ingredients</code> are carried through your process 
with <code>Events</code>, and are inputs for <code>Interactions</code>.</p>
<p>For a <code>Recipe</code> there exist <code>Ingredients</code> which are a name and a <code>Type</code>, they are used to model the data of your process.</p>
<p>For a <code>RecipeInstance</code> there exist <code>IngredientInstance</code>s, which are a name and a <code>Value</code>, they are used to move data 
through your process. </p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">com.ing.baker.recipe.scaladsl.Ingredient</span>

<span class="k">val</span> <span class="nc">OrderId</span><span class="k">:</span> <span class="kt">Ingredient</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
    <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;orderId&quot;</span><span class="o">)</span>


<span class="k">import</span> <span class="nn">com.ing.baker.runtime.scaladsl.IngredientInstance</span>

<span class="k">val</span> <span class="n">orderIdInstance</span><span class="k">:</span> <span class="kt">IngredientInstance</span> <span class="o">=</span> 
    <span class="nc">IngredientInstance</span><span class="o">(</span><span class="s">&quot;orderId&quot;</span><span class="o">,</span> <span class="nc">PrimitiveValue</span><span class="o">(</span><span class="s">&quot;uuid-123456789&quot;</span><span class="o">))</span>
</code></pre></div>

</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">// In Java, Ingredients are extracted from a class </span>
<span class="c1">// representing an Event by using java reflection.</span>
<span class="c1">// See the full example at the &quot;Recipe and RecipeInstance&quot; section</span>
</code></pre></div>

</div>
</div>
<h2 id="event-and-eventinstance">Event and EventInstance</h2>
<p><code>Events</code> represent happenings in your process that might carry <code>Ingredients</code>, they represent an "asynchronous boundary",
they are always either output from <code>Interactions</code> or a special case called <code>SensoryEvent</code>s; we call sensory events to the 
events that come from "outside" of your recipe and are normally used to start your process.</p>
<p>For a <code>Recipe</code> there exist <code>Events</code> which are a name, a set of <code>Ingredients</code> and a maximum amount of firings; the 
<code>maxFiringLimit</code> is a property which describes the number of times an event is allowed to fire, this is later on
enforced by the Baker runtime. To know more about firing limits and all the other configurable properties, please 
refer to the <a href="../../reference/dsls/">DSLs documentation</a>.</p>
<p>For a <code>RecipeInstance</code> there exist <code>EventInstance</code>s which are data structures that must match their interface equivalent
declared as <code>Events</code> on the <code>Recipe</code>. They notify a baker <code>RecipeInstance</code> of an actual happening and may carry <code>Ingredient</code>
values; the baker <code>RecipeInstance</code> will then use available <code>Ingredients</code> to execute <code>InteractionInstance</code>s.</p>
<p><strong>Note: Names of sensory <code>Event</code> and <code>EventInstance</code> must match, so that Baker can correctly execute your process flow.</strong></p>
<div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="cm">/** Event */</span>
<span class="k">import</span> <span class="nn">com.ing.baker.recipe.scaladsl.Event</span>
<span class="k">import</span> <span class="nn">com.ing.baker.recipe.scaladsl.Ingredient</span>

<span class="k">val</span> <span class="nc">OrderPlaced</span><span class="k">:</span> <span class="kt">Event</span> <span class="o">=</span> <span class="nc">Event</span><span class="o">(</span>
  <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;OrderPlaced&quot;</span><span class="o">,</span>
  <span class="n">providedIngredients</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
    <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;orderId&quot;</span><span class="o">),</span>
    <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]](</span><span class="s">&quot;items&quot;</span><span class="o">)</span>
  <span class="o">),</span>
  <span class="n">maxFiringLimit</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="o">)</span>

<span class="cm">/** EventInstance */</span>
<span class="k">import</span> <span class="nn">com.ing.baker.runtime.scaladsl.EventInstance</span>
<span class="k">import</span> <span class="nn">com.ing.baker.types.</span><span class="o">{</span><span class="nc">PrimitiveValue</span><span class="o">,</span> <span class="nc">ListValue</span><span class="o">}</span>

<span class="k">val</span> <span class="n">firstOrderPlaced</span><span class="k">:</span> <span class="kt">EventInstance</span> <span class="o">=</span> <span class="nc">EventInstance</span><span class="o">(</span>
  <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;OrderPlaced&quot;</span><span class="o">,</span>
  <span class="n">providedIngredients</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span>
    <span class="s">&quot;orderId&quot;</span> <span class="o">-&gt;</span> <span class="nc">PrimitiveValue</span><span class="o">(</span><span class="s">&quot;uuid-0123456789&quot;</span><span class="o">),</span>
    <span class="s">&quot;items&quot;</span> <span class="o">-&gt;</span> <span class="nc">ListValue</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="nc">PrimitiveValue</span><span class="o">(</span><span class="s">&quot;item1-id&quot;</span><span class="o">),</span> <span class="nc">PrimitiveValue</span><span class="o">(</span><span class="s">&quot;item2-id&quot;</span><span class="o">)))</span>
  <span class="o">)</span>
<span class="o">)</span>
</code></pre></div>

</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">// In Java, Events and EventInstances are extracted from a </span>
<span class="c1">// class by using java reflection.</span>
<span class="c1">// Please check the full recipe example below on the </span>
<span class="c1">// Recipe and RecipeInstance subsection</span>

<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.javadsl.EventInstance</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">OrderPlaced</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">orderId</span><span class="p">;</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">OrderPlaced</span><span class="p">(</span><span class="n">String</span> <span class="n">orderId</span><span class="p">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">orderId</span> <span class="o">=</span> <span class="n">orderId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item2&quot;</span><span class="p">);</span>
<span class="n">OrderPlaced</span> <span class="n">order1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrderPlaced</span><span class="p">(</span><span class="s">&quot;uuid-0123456789&quot;</span><span class="p">,</span> <span class="n">items</span><span class="p">);</span>
<span class="n">EventInstance</span> <span class="n">order1Event</span> <span class="o">=</span> <span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">order1</span><span class="p">);</span>
</code></pre></div>

</div>
</div>
<p>To fire a <code>SensoryEvent</code> use the <code>bakerRuntime.fireEvent(recipeInstanceId, event)</code> API variations, 
after creating the baker runtime, adding your recipe to the runtime and <code>baking</code> a <code>RecipeInstance</code>. For full 
documentation on this please refer to the <a href="../../reference/runtime/">runtime documentation</a>.</p>
<div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">akka.actor.ActorSystem</span>
<span class="k">import</span> <span class="nn">com.ing.baker.runtime.common.EventResult</span>
<span class="k">import</span> <span class="nn">com.ing.baker.runtime.scaladsl.</span><span class="o">{</span><span class="nc">Baker</span><span class="o">,</span> <span class="nc">EventInstance</span><span class="o">}</span>

<span class="k">import</span> <span class="nn">scala.concurrent.Future</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">actorSystem</span><span class="k">:</span> <span class="kt">ActorSystem</span> <span class="o">=</span>
    <span class="nc">ActorSystem</span><span class="o">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">baker</span><span class="k">:</span> <span class="kt">Baker</span> <span class="o">=</span> <span class="nc">AkkaBaker</span><span class="o">.</span><span class="n">localDefault</span><span class="o">(</span><span class="n">actorSystem</span><span class="o">)</span>

<span class="c1">// This example is using the reflection API `EventInstance.unsafeFrom`</span>
<span class="k">val</span> <span class="nc">FirstOrderPlaced</span><span class="k">:</span> <span class="kt">EventInstance</span> <span class="o">=</span> <span class="nc">EventInstance</span>
    <span class="o">.</span><span class="n">unsafeFrom</span><span class="o">(</span><span class="nc">OrderPlaced</span><span class="o">(</span><span class="s">&quot;order-uuid&quot;</span><span class="o">,</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;item1&quot;</span><span class="o">,</span> <span class="s">&quot;item2&quot;</span><span class="o">)))</span>
<span class="k">val</span> <span class="n">recipeInstanceId</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&quot;recipe id from previously baked recipe instance&quot;</span>

<span class="k">val</span> <span class="n">result</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EventResult</span><span class="o">]</span> <span class="k">=</span> <span class="n">baker</span><span class="o">.</span><span class="n">fireEventAndResolveWhenCompleted</span><span class="o">(</span><span class="n">recipeInstanceId</span><span class="o">,</span> <span class="nc">FirstOrderPlaced</span><span class="o">)</span>
</code></pre></div>

</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">akka.actor.ActorSystem</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.akka.AkkaBaker</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.javadsl.EventInstance</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.javadsl.EventResult</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.concurrent.CompletableFuture</span><span class="p">;</span>

<span class="n">ActorSystem</span> <span class="n">actorSystem</span> <span class="o">=</span> <span class="n">ActorSystem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">);</span>
<span class="n">Baker</span> <span class="n">baker</span> <span class="o">=</span> <span class="n">AkkaBaker</span><span class="p">.</span><span class="na">javaLocalDefault</span><span class="p">(</span><span class="n">actorSystem</span><span class="p">);</span>

<span class="n">String</span> <span class="n">recipeInstanceId</span> <span class="o">=</span> <span class="s">&quot;recipe id from previously baked recipe instance&quot;</span><span class="p">;</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item2&quot;</span><span class="p">);</span>
<span class="n">EventInstance</span> <span class="n">firstOrderPlaced</span> <span class="o">=</span> 
        <span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span> <span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">OrderPlaced</span><span class="p">(</span><span class="s">&quot;order-uuid&quot;</span><span class="p">,</span> <span class="n">items</span><span class="p">));</span>

<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">EventResult</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">baker</span><span class="p">.</span><span class="na">fireEventAndResolveWhenCompleted</span><span class="p">(</span><span class="n">recipeInstanceId</span><span class="p">,</span> <span class="n">firstOrderPlaced</span><span class="p">);</span>
</code></pre></div>

</div>
</div>
<h2 id="interaction-and-interactioninstance">Interaction and InteractionInstance</h2>
<p>An interaction resemblance a function, it requires input (<code>Ingredients</code>) and provides output (<code>Events</code>). Within this
contract it may do anything. For example:</p>
<ul>
<li>Query a microservice</li>
<li>Send messages to an event broker like Kafka</li>
<li>Await for a message from an event broker</li>
<li>Generate a file</li>
<li>Do transformations on the ingredients (we like to call these interactions <code>Sieves</code>)</li>
</ul>
<p>For a <code>Recipe</code> there exist <code>Interactions</code> which are a name, a sequence of <code>Ingredients</code> describing all the input (all of),
and a sequence of <code>Events</code> describing the <em>possible</em> event outputs (one of). At the recipe level there are several more 
specifics that can be configured, like requiring events without ingredients, adding predefined ingredients, overriding
ingredient names, or handling unexpected failure, for these please refer to the <a href="../../reference/dsls/">DSLs documentation</a>.</p>
<p>For a <code>RecipeInstance</code> there exist <code>InteractionInstance</code>s which are a name, an input type description, and an implementation
of a method/function that will be called when the interaction is executed. The input name and the input type description 
is used by the Baker runtime to find the correct <code>InteractionImplementation</code> to execute when the <code>Ingredients</code> are available.</p>
<p><strong>Note: Names of sensory <code>Event</code> and <code>EventInstance</code> must match, so that Baker can correctly execute your process flow.</strong></p>
<p><strong>Note: For asynchronous programming, the Scala DSL <code>InteractionInstance</code> can return a <code>Future[A]</code> and the Java DSL can
return a <code>CompletableFuture&lt;A&gt;</code>, and the Baker runtime will handle the async results of the instances.</strong></p>
<div class="tabbed-set" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="cm">/** Interaction */</span>
<span class="k">import</span> <span class="nn">com.ing.baker.recipe.scaladsl.</span><span class="o">{</span><span class="nc">Event</span><span class="o">,</span> <span class="nc">Ingredient</span><span class="o">,</span> <span class="nc">Interaction</span><span class="o">}</span>

<span class="k">val</span> <span class="nc">ReserveItems</span><span class="k">:</span> <span class="kt">Interaction</span> <span class="o">=</span> <span class="nc">Interaction</span><span class="o">(</span>
    <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;ReserveItems&quot;</span><span class="o">,</span>
    <span class="n">inputIngredients</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
        <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;orderId&quot;</span><span class="o">),</span>
        <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]](</span><span class="s">&quot;items&quot;</span><span class="o">)</span>
    <span class="o">),</span>
    <span class="n">output</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
        <span class="nc">Events</span><span class="o">.</span><span class="nc">OrderHadUnavailableItems</span><span class="o">,</span>
        <span class="nc">Events</span><span class="o">.</span><span class="nc">ItemsReserved</span>
    <span class="o">)</span>
<span class="o">)</span>

<span class="cm">/** InteractionInstance */</span>
<span class="k">import</span> <span class="nn">com.ing.baker.runtime.scaladsl.</span><span class="o">{</span><span class="nc">EventInstance</span><span class="o">,</span> <span class="nc">IngredientInstance</span><span class="o">,</span> <span class="nc">InteractionInstance</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">com.ing.baker.types.</span><span class="o">{</span><span class="nc">CharArray</span><span class="o">,</span> <span class="nc">ListType</span><span class="o">,</span> <span class="nc">ListValue</span><span class="o">,</span> <span class="nc">PrimitiveValue</span><span class="o">}</span>

<span class="k">import</span> <span class="nn">scala.concurrent.Future</span>
<span class="k">import</span> <span class="nn">scala.concurrent.ExecutionContext.Implicits.global</span>

<span class="k">val</span> <span class="nc">ReserveItemsInstance</span> <span class="k">=</span> <span class="nc">InteractionInstance</span><span class="o">(</span>
    <span class="n">name</span> <span class="k">=</span> <span class="nc">ReserveItems</span><span class="o">.</span><span class="n">name</span><span class="o">,</span>
    <span class="n">input</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="nc">CharArray</span><span class="o">,</span> <span class="nc">ListType</span><span class="o">(</span><span class="nc">CharArray</span><span class="o">))</span>
    <span class="n">run</span> <span class="k">=</span> <span class="n">handleReserveItems</span>
<span class="o">)</span>

<span class="k">def</span> <span class="n">handleReserveItems</span><span class="o">(</span><span class="n">input</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">IngredientInstance</span><span class="o">])</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">EventInstance</span><span class="o">]]</span> <span class="k">=</span> <span class="o">???</span>
    <span class="c1">// ListValue and PrimitiveValue are used in the body</span>
</code></pre></div>

</div>
<input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><label for="__tabbed_5_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="cm">/** Interaction */</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.recipe.annotations.FiresEvent</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.recipe.annotations.RequiresIngredient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.recipe.javadsl.Interaction</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ReserveItems</span> <span class="kd">extends</span> <span class="n">Interaction</span> <span class="p">{</span>

    <span class="kd">interface</span> <span class="nc">ReserveItemsOutcome</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nc">OrderHadUnavailableItems</span> <span class="kd">implements</span> <span class="n">ReserveItemsOutcome</span> <span class="p">{</span>

        <span class="kd">public</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">unavailableItems</span><span class="p">;</span>

        <span class="kd">public</span> <span class="nf">OrderHadUnavailableItems</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">unavailableItems</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">unavailableItems</span> <span class="o">=</span> <span class="n">unavailableItems</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nc">ItemsReserved</span> <span class="kd">implements</span> <span class="n">ReserveItemsOutcome</span> <span class="p">{</span>

        <span class="kd">public</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">reservedItems</span><span class="p">;</span>

        <span class="kd">public</span> <span class="nf">ItemsReserved</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">reservedItems</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">reservedItems</span> <span class="o">=</span> <span class="n">reservedItems</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Annotations are needed for wiring ingredients and validating events.</span>
    <span class="nd">@FiresEvent</span><span class="p">(</span><span class="n">oneOf</span> <span class="o">=</span> <span class="p">{</span><span class="n">OrderHadUnavailableItems</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ItemsReserved</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
    <span class="c1">// The name of the method must be &quot;apply&quot; for the reflection API to work.</span>
    <span class="c1">// This method can also return a `CompletableFuture&lt;ReserveItemsOutcome&gt;` for asynchronous programming.</span>
    <span class="n">ReserveItemsOutcome</span> <span class="nf">apply</span><span class="p">(</span><span class="nd">@RequiresIngredient</span><span class="p">(</span><span class="s">&quot;orderId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="nd">@RequiresIngredient</span><span class="p">(</span><span class="s">&quot;items&quot;</span><span class="p">)</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/** InteractionInstance */</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.javadsl.InteractionInstance</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReserveItems</span> <span class="kd">implements</span> <span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">ReserveItems</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">ReserveItemsOutcome</span> <span class="nf">apply</span><span class="p">(</span><span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">ReserveItems</span><span class="p">.</span><span class="na">ItemsReserved</span><span class="p">(</span><span class="n">items</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</div>
<input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><label for="__tabbed_5_3">Scala (Reflection API)</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">// See the DSLs documentation for more on the reflection API</span>
<span class="k">trait</span> <span class="nc">ReserveItems</span> <span class="o">{</span>

    <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">orderId</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">items</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">WebshopRecipeReflection.ReserveItemsOutput</span><span class="o">]</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">ReserveItemsInstance</span> <span class="k">extends</span> <span class="nc">ReserveItems</span> <span class="o">{</span>

  <span class="k">override</span> <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">orderId</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">items</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">WebshopRecipeReflection.ReserveItemsOutput</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>

    <span class="c1">// Http call to the Warehouse service</span>
    <span class="k">val</span> <span class="n">response</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Either</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span><span class="p">,</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]]]</span> <span class="k">=</span>
    <span class="c1">// This is mocked for the sake of the example</span>
      <span class="nc">Future</span><span class="o">.</span><span class="n">successful</span><span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="n">items</span><span class="o">))</span>

    <span class="c1">// Build an event instance that Baker understands</span>
    <span class="n">response</span><span class="o">.</span><span class="n">map</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">Left</span><span class="o">(</span><span class="n">unavailableItems</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="nc">WebshopRecipeReflection</span><span class="o">.</span><span class="nc">OrderHadUnavailableItems</span><span class="o">(</span><span class="n">unavailableItems</span><span class="o">)</span>
      <span class="k">case</span> <span class="nc">Right</span><span class="o">(</span><span class="n">reservedItems</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="nc">WebshopRecipeReflection</span><span class="o">.</span><span class="nc">ItemsReserved</span><span class="o">(</span><span class="n">reservedItems</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">reserveItemsInstance</span><span class="k">:</span> <span class="kt">InteractionInstance</span> <span class="o">=</span>
  <span class="nc">InteractionInstance</span><span class="o">.</span><span class="n">unsafeFrom</span><span class="o">(</span><span class="k">new</span> <span class="nc">ReserveItemsInstance</span><span class="o">)</span>
</code></pre></div>

</div>
</div>
<p>After creating your <code>InteractionInstance</code>s, you need to add them to the baker runtime so that Baker can match them to the <code>Interactions</code>
of your <code>Recipe</code> and call them when needed.</p>
<div class="tabbed-set" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><label for="__tabbed_6_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">akka.actor.ActorSystem</span>
<span class="k">import</span> <span class="nn">com.ing.baker.runtime.scaladsl.Baker</span>

<span class="k">import</span> <span class="nn">scala.concurrent.Future</span>

<span class="k">val</span> <span class="n">done</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="n">baker</span><span class="o">.</span><span class="n">addInteractionInstance</span><span class="o">(</span><span class="n">reserveItemsInstance</span><span class="o">)</span>
</code></pre></div>

</div>
<input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><label for="__tabbed_6_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">akka.actor.ActorSystem</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.akka.AkkaBaker</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">scala.runtime.BoxedUnit</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.CompletableFuture</span><span class="p">;</span>

<span class="n">ActorSystem</span> <span class="n">actorSystem</span> <span class="o">=</span> <span class="n">ActorSystem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">);</span>
<span class="n">Baker</span> <span class="n">baker</span> <span class="o">=</span> <span class="n">AkkaBaker</span><span class="p">.</span><span class="na">javaLocalDefault</span><span class="p">(</span><span class="n">actorSystem</span><span class="p">);</span>

<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">BoxedUnit</span><span class="o">&gt;</span> <span class="n">done</span> <span class="o">=</span> <span class="n">baker</span><span class="p">.</span><span class="na">addInteractionInstance</span><span class="p">(</span><span class="n">reserveItemsInstance</span><span class="p">);</span>
</code></pre></div>

</div>
</div>
<h2 id="recipe-and-recipeinstance">Recipe and RecipeInstance</h2>
<p>All you <code>Ingredients</code>, <code>Events</code> and <code>Interactions</code> must be added to a single unit called the <code>Recipe</code>, which works as the
"blueprint" of your precess.</p>
<div class="tabbed-set" data-tabs="7:4"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><label for="__tabbed_7_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">com.ing.baker.recipe.scaladsl.Recipe</span>

<span class="k">val</span> <span class="n">recipe</span><span class="k">:</span> <span class="kt">Recipe</span> <span class="o">=</span> <span class="nc">Recipe</span><span class="o">(</span><span class="s">&quot;Webshop&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">withSensoryEvents</span><span class="o">(</span>
        <span class="nc">Events</span><span class="o">.</span><span class="nc">OrderPlaced</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="n">withInteractions</span><span class="o">(</span>
        <span class="nc">Interactions</span><span class="o">.</span><span class="nc">ReserveItems</span><span class="o">,</span>
    <span class="o">)</span>
</code></pre></div>

</div>
<input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><label for="__tabbed_7_2">Scala Full Example</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">package</span> <span class="nn">webshop</span>

<span class="k">import</span> <span class="nn">com.ing.baker.recipe.scaladsl.</span><span class="o">{</span><span class="nc">Event</span><span class="o">,</span> <span class="nc">Ingredient</span><span class="o">,</span> <span class="nc">Interaction</span><span class="o">,</span> <span class="nc">Recipe</span><span class="o">}</span>

<span class="k">object</span> <span class="nc">WebshopRecipeReflection</span> <span class="o">{</span>

  <span class="k">case</span> <span class="k">class</span> <span class="nc">OrderPlaced</span><span class="o">(</span><span class="n">orderId</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">items</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span>

  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">ReserveItemsOutput</span>

  <span class="k">case</span> <span class="k">class</span> <span class="nc">OrderHadUnavailableItems</span><span class="o">(</span><span class="n">unavailableItems</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">ReserveItemsOutput</span>

  <span class="k">case</span> <span class="k">class</span> <span class="nc">ItemsReserved</span><span class="o">(</span><span class="n">reservedItems</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">ReserveItemsOutput</span>

  <span class="k">val</span> <span class="nc">ReserveItems</span> <span class="k">=</span> <span class="nc">Interaction</span><span class="o">(</span>
    <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;ReserveItems&quot;</span><span class="o">,</span>
    <span class="n">inputIngredients</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;orderId&quot;</span><span class="o">),</span>
      <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]](</span><span class="s">&quot;items&quot;</span><span class="o">)</span>
    <span class="o">),</span>
    <span class="n">output</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="nc">Event</span><span class="o">[</span><span class="kt">OrderHadUnavailableItems</span><span class="o">],</span>
      <span class="nc">Event</span><span class="o">[</span><span class="kt">ItemsReserved</span><span class="o">]</span>
    <span class="o">)</span>
  <span class="o">)</span>

  <span class="k">val</span> <span class="n">recipe</span><span class="k">:</span> <span class="kt">Recipe</span> <span class="o">=</span> <span class="nc">Recipe</span><span class="o">(</span><span class="s">&quot;Webshop&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">withSensoryEvents</span><span class="o">(</span>
      <span class="nc">Event</span><span class="o">[</span><span class="kt">OrderPlaced</span><span class="o">],</span>
      <span class="nc">Event</span><span class="o">[</span><span class="kt">OrderHadUnavailableItems</span><span class="o">],</span>
      <span class="nc">Event</span><span class="o">[</span><span class="kt">ItemsReserved</span><span class="o">]</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="n">withInteractions</span><span class="o">(</span>
      <span class="nc">ReserveItems</span>
    <span class="o">)</span>
<span class="o">}</span>
</code></pre></div>

</div>
<input id="__tabbed_7_3" name="__tabbed_7" type="radio" /><label for="__tabbed_7_3">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">com.ing.baker.recipe.javadsl.Recipe</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">com.ing.baker.recipe.javadsl.InteractionDescriptor.of</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Recipe</span> <span class="n">recipe</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Recipe</span><span class="p">(</span><span class="s">&quot;WebshopRecipe&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="na">withSensoryEvents</span><span class="p">(</span><span class="n">OrderPlaced</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
        <span class="p">.</span><span class="na">withInteractions</span><span class="p">(</span><span class="n">of</span><span class="p">(</span><span class="n">ReserveItems</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</code></pre></div>

</div>
<input id="__tabbed_7_4" name="__tabbed_7" type="radio" /><label for="__tabbed_7_4">Java Full Example</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">package</span> <span class="nn">webshop</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.ing.baker.recipe.annotations.FiresEvent</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.recipe.annotations.RequiresIngredient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.recipe.javadsl.Interaction</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.recipe.javadsl.Recipe</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span> <span class="nn">com.ing.baker.recipe.javadsl.InteractionDescriptor.of</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JWebshopRecipe</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">OrderPlaced</span> <span class="p">{</span>

        <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">orderId</span><span class="p">;</span>
        <span class="kd">public</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="p">;</span>

        <span class="kd">public</span> <span class="nf">OrderPlaced</span><span class="p">(</span><span class="n">String</span> <span class="n">orderId</span><span class="p">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">orderId</span> <span class="o">=</span> <span class="n">orderId</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="na">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ReserveItems</span> <span class="kd">extends</span> <span class="n">Interaction</span> <span class="p">{</span>

        <span class="kd">interface</span> <span class="nc">ReserveItemsOutcome</span> <span class="p">{</span>
        <span class="p">}</span>

        <span class="kd">class</span> <span class="nc">OrderHadUnavailableItems</span> <span class="kd">implements</span> <span class="n">ReserveItemsOutcome</span> <span class="p">{</span>

            <span class="kd">public</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">unavailableItems</span><span class="p">;</span>

            <span class="kd">public</span> <span class="nf">OrderHadUnavailableItems</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">unavailableItems</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">unavailableItems</span> <span class="o">=</span> <span class="n">unavailableItems</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kd">class</span> <span class="nc">ItemsReserved</span> <span class="kd">implements</span> <span class="n">ReserveItemsOutcome</span> <span class="p">{</span>

            <span class="kd">public</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">reservedItems</span><span class="p">;</span>

            <span class="kd">public</span> <span class="nf">ItemsReserved</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">reservedItems</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">reservedItems</span> <span class="o">=</span> <span class="n">reservedItems</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nd">@FiresEvent</span><span class="p">(</span><span class="n">oneOf</span> <span class="o">=</span> <span class="p">{</span><span class="n">OrderHadUnavailableItems</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">ItemsReserved</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
        <span class="n">ReserveItemsOutcome</span> <span class="nf">apply</span><span class="p">(</span><span class="nd">@RequiresIngredient</span><span class="p">(</span><span class="s">&quot;orderId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="nd">@RequiresIngredient</span><span class="p">(</span><span class="s">&quot;items&quot;</span><span class="p">)</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Recipe</span> <span class="n">recipe</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Recipe</span><span class="p">(</span><span class="s">&quot;WebshopRecipe&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="na">withSensoryEvents</span><span class="p">(</span><span class="n">OrderPlaced</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
        <span class="p">.</span><span class="na">withInteractions</span><span class="p">(</span><span class="n">of</span><span class="p">(</span><span class="n">ReserveItems</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>

</div>
</div>
<p>A recipe must be added to a baker runtime so that you can create "bake" a <code>RecipeInstance</code> from it. For that it must be
first "compiled" by using the provided compiler.</p>
<p>Here is a full example of creating a baker runtime, adding the <code>InteractionInstances</code> and the compiled <code>Recipe</code> (order matters
becase baker validates that all recipes have valid implementations when added), and firing an <code>Event</code> that will execute 
the <code>Interaction</code></p>
<div class="tabbed-set" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><label for="__tabbed_8_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">akka.actor.ActorSystem</span>
<span class="k">import</span> <span class="nn">com.ing.baker.compiler.RecipeCompiler</span>
<span class="k">import</span> <span class="nn">com.ing.baker.il.CompiledRecipe</span>
<span class="k">import</span> <span class="nn">com.ing.baker.runtime.scaladsl.EventInstance</span>
<span class="k">import</span> <span class="nn">com.ing.baker.runtime.akka.AkkaBaker</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">actorSystem</span><span class="k">:</span> <span class="kt">ActorSystem</span> <span class="o">=</span>
    <span class="nc">ActorSystem</span><span class="o">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">baker</span><span class="k">:</span> <span class="kt">Baker</span> <span class="o">=</span> <span class="nc">AkkaBaker</span><span class="o">.</span><span class="n">localDefault</span><span class="o">(</span><span class="n">actorSystem</span><span class="o">)</span>

<span class="k">val</span> <span class="n">compiledRecipe</span><span class="k">:</span> <span class="kt">CompiledRecipe</span> <span class="o">=</span> <span class="nc">RecipeCompiler</span><span class="o">.</span><span class="n">compileRecipe</span><span class="o">(</span><span class="nc">WebshopRecipe</span><span class="o">.</span><span class="n">recipe</span><span class="o">)</span>

<span class="k">val</span> <span class="n">program</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
    <span class="k">_</span> <span class="k">&lt;-</span> <span class="n">baker</span><span class="o">.</span><span class="n">addInteractionInstance</span><span class="o">(</span><span class="nc">WebshopInstances</span><span class="o">.</span><span class="nc">ReserveItemsInstance</span><span class="o">)</span>
    <span class="n">recipeId</span> <span class="k">&lt;-</span> <span class="n">baker</span><span class="o">.</span><span class="n">addRecipe</span><span class="o">(</span><span class="nc">RecipeRecord</span><span class="o">.</span><span class="n">of</span><span class="o">(</span><span class="n">compiledRecipe</span><span class="o">))</span>
    <span class="k">_</span> <span class="k">&lt;-</span> <span class="n">baker</span><span class="o">.</span><span class="n">bake</span><span class="o">(</span><span class="n">recipeId</span><span class="o">,</span> <span class="s">&quot;first-instance-id&quot;</span><span class="o">)</span>
    <span class="n">firstOrderPlaced</span><span class="k">:</span> <span class="kt">EventInstance</span> <span class="o">=</span>
        <span class="nc">EventInstance</span><span class="o">.</span><span class="n">unsafeFrom</span><span class="o">(</span><span class="nc">WebshopRecipeReflection</span><span class="o">.</span><span class="nc">OrderPlaced</span><span class="o">(</span><span class="s">&quot;order-uuid&quot;</span><span class="o">,</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;item1&quot;</span><span class="o">,</span> <span class="s">&quot;item2&quot;</span><span class="o">)))</span>
    <span class="n">result</span> <span class="k">&lt;-</span> <span class="n">baker</span><span class="o">.</span><span class="n">fireEventAndResolveWhenCompleted</span><span class="o">(</span><span class="s">&quot;first-instance-id&quot;</span><span class="o">,</span> <span class="n">firstOrderPlaced</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">assert</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="n">events</span> <span class="o">==</span> <span class="nc">Seq</span><span class="o">(</span>
    <span class="nc">WebshopRecipe</span><span class="o">.</span><span class="nc">Events</span><span class="o">.</span><span class="nc">OrderPlaced</span><span class="o">.</span><span class="n">name</span><span class="o">,</span>
    <span class="nc">WebshopRecipe</span><span class="o">.</span><span class="nc">Events</span><span class="o">.</span><span class="nc">ItemsReserved</span><span class="o">.</span><span class="n">name</span>
<span class="o">))</span>
</code></pre></div>

</div>
<input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><label for="__tabbed_8_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">akka.actor.ActorSystem</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.compiler.RecipeCompiler</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.il.CompiledRecipe</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.akka.AkkaBaker</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.javadsl.EventInstance</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.javadsl.EventResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ing.baker.runtime.javadsl.InteractionInstance</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.CompletableFuture</span><span class="p">;</span>


<span class="n">ActorSystem</span> <span class="n">actorSystem</span> <span class="o">=</span> <span class="n">ActorSystem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">);</span>
<span class="n">Baker</span> <span class="n">baker</span> <span class="o">=</span> <span class="n">AkkaBaker</span><span class="p">.</span><span class="na">javaLocalDefault</span><span class="p">(</span><span class="n">actorSystem</span><span class="p">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item2&quot;</span><span class="p">);</span>
<span class="n">EventInstance</span> <span class="n">firstOrderPlaced</span> <span class="o">=</span>
        <span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span> <span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">OrderPlaced</span><span class="p">(</span><span class="s">&quot;order-uuid&quot;</span><span class="p">,</span> <span class="n">items</span><span class="p">));</span>

<span class="n">InteractionInstance</span> <span class="n">reserveItemsInstance</span> <span class="o">=</span> <span class="n">InteractionInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span> <span class="n">ReserveItems</span><span class="p">());</span>
<span class="n">CompiledRecipe</span> <span class="n">compiledRecipe</span> <span class="o">=</span> <span class="n">RecipeCompiler</span><span class="p">.</span><span class="na">compileRecipe</span><span class="p">(</span><span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">recipe</span><span class="p">);</span>

<span class="n">String</span> <span class="n">recipeInstanceId</span> <span class="o">=</span> <span class="s">&quot;first-instance-id&quot;</span><span class="p">;</span>
<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">baker</span><span class="p">.</span><span class="na">addInteractionInstance</span><span class="p">(</span><span class="n">reserveItemsInstance</span><span class="p">)</span>
    <span class="p">.</span><span class="na">thenCompose</span><span class="p">(</span><span class="n">ignore</span> <span class="o">-&gt;</span> <span class="n">baker</span><span class="p">.</span><span class="na">addRecipe</span><span class="p">(</span><span class="n">RecipeRecord</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">compiledRecipe</span><span class="p">)))</span>
    <span class="p">.</span><span class="na">thenCompose</span><span class="p">(</span><span class="n">recipeId</span> <span class="o">-&gt;</span> <span class="n">baker</span><span class="p">.</span><span class="na">bake</span><span class="p">(</span><span class="n">recipeId</span><span class="p">,</span> <span class="n">recipeInstanceId</span><span class="p">))</span>
    <span class="p">.</span><span class="na">thenCompose</span><span class="p">(</span><span class="n">ignore</span> <span class="o">-&gt;</span> <span class="n">baker</span><span class="p">.</span><span class="na">fireEventAndResolveWhenCompleted</span><span class="p">(</span><span class="n">recipeInstanceId</span><span class="p">,</span> <span class="n">firstOrderPlaced</span><span class="p">))</span>
    <span class="p">.</span><span class="na">thenApply</span><span class="p">(</span><span class="n">EventResult</span><span class="p">::</span><span class="n">events</span><span class="p">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">blockedResult</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="na">join</span><span class="p">();</span>
<span class="k">assert</span><span class="p">(</span><span class="n">blockedResult</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;OrderPlaced&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">blockedResult</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;ReservedItems&quot;</span><span class="p">));</span>
</code></pre></div>

</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../development-life-cycle/resolve-failed-recipe-instances/" title="Resolve Failed Recipes" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Resolve Failed Recipes
              </div>
            </div>
          </a>
        
        
          <a href="../execution-semantics/" title="Execution Semantics" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Execution Semantics
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.3636a4ec.min.js"></script>
      <script src="../../../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>