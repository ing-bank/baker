
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../cookbook/monitoring/">
      
      
        <link rel="next" href="../execution-semantics/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Main Abstractions - Baker</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/ing.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#main-abstractions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Baker" class="md-header__button md-logo" aria-label="Baker" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Baker
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Main Abstractions
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ing-bank/baker" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Baker" class="md-nav__button md-logo" aria-label="Baker" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Baker
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ing-bank/baker" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart-guide/" class="md-nav__link">
        Quickstart guide
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Cookbook
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Cookbook
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/recipe-dsl/" class="md-nav__link">
        Recipe DSL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/error-handling/" class="md-nav__link">
        Error handling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/visualizations/" class="md-nav__link">
        Visualizations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/fire-sensory-events/" class="md-nav__link">
        Fire events and inquiry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/interaction-execution/" class="md-nav__link">
        Interaction execution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Main Abstractions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Main Abstractions
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#type-and-value" class="md-nav__link">
    Type and Value
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingredient-and-ingredientinstance" class="md-nav__link">
    Ingredient and IngredientInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-and-eventinstance" class="md-nav__link">
    Event and EventInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interaction-and-interactioninstance" class="md-nav__link">
    Interaction and InteractionInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-and-recipeinstance" class="md-nav__link">
    Recipe and RecipeInstance
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../execution-semantics/" class="md-nav__link">
        Execution Semantics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../baker-types-and-values/" class="md-nav__link">
        Baker Types and Values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/" class="md-nav__link">
        The Baker Runtime
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../stores/" class="md-nav__link">
        Event Stores and Cluster Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Versions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Versions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../versions/baker-3-release-notes/" class="md-nav__link">
        Release Notes v3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../versions/baker-3/" class="md-nav__link">
        Migration Guide v3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../versions/baker-2/" class="md-nav__link">
        Migration Guide v2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../feature-comparison/" class="md-nav__link">
        Feature comparison
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#type-and-value" class="md-nav__link">
    Type and Value
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingredient-and-ingredientinstance" class="md-nav__link">
    Ingredient and IngredientInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-and-eventinstance" class="md-nav__link">
    Event and EventInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interaction-and-interactioninstance" class="md-nav__link">
    Interaction and InteractionInstance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-and-recipeinstance" class="md-nav__link">
    Recipe and RecipeInstance
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="main-abstractions">Main Abstractions</h1>
<p>Baker makes a strong division between the specification of your business process and the runtime implementations.</p>
<table>
<thead>
<tr>
<th>Specification</th>
<th>Runtime</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Type</code></td>
<td><code>Value</code></td>
</tr>
<tr>
<td><code>Ingredient</code></td>
<td><code>IngredientInstance</code></td>
</tr>
<tr>
<td><code>Event</code></td>
<td><code>EventInstance</code></td>
</tr>
<tr>
<td><code>Interaction</code></td>
<td><code>InteractionInstance</code></td>
</tr>
<tr>
<td><code>Recipe</code></td>
<td><code>RecipeInstance</code></td>
</tr>
</tbody>
</table>
<p>The first four are used to create <code>Recipe</code>s which serve as "blueprints" of your process. In the Baker
runtime they are used within <code>RecipeInstance</code>s, which are created from a <code>Recipe</code> specification to execute the flow of 
your process.</p>
<h2 id="type-and-value">Type and Value</h2>
<p>Because of the distributed nature of Baker and how the runtime works, we need to have serializable types and values to 
transfer recipes and data between nodes and to match over such data, that is why we implemented a type system on top of Scala.
They help not just to model your domain, but also for Baker to identify when to execute interactions. </p>
<p>If you are using all of our reflection APIs then you will not use them directly, but it is good to know of their 
existence.</p>
<p>Full documentation about the type system can be found <a href="../../reference/baker-types-and-values/">here</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Scala</label><label for="__tabbed_1_2">Java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">types</span><span class="p">.</span><span class="n">_</span>

<span class="kd">val</span><span class="w"> </span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="nc">Type</span><span class="p">,</span><span class="w"> </span><span class="nc">Value</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nc">Int32</span><span class="p">,</span><span class="w"> </span><span class="nc">PrimitiveValue</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.types.*</span><span class="p">;</span>

<span class="n">Type</span><span class="w"> </span><span class="n">dataType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Int32$</span><span class="p">.</span><span class="na">MODULE$</span><span class="p">;</span>
<span class="n">Value</span><span class="w"> </span><span class="n">dataValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PrimitiveValue</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="ingredient-and-ingredientinstance">Ingredient and IngredientInstance</h2>
<p><code>Ingredients</code> are containers for the data in your process. This data is <strong>immutable</strong>, which means that it can only be created and never 
changes in the process. There is <strong>no subtyping</strong>, nor hierarchy. <code>Ingredients</code> are carried through your process 
with <code>Events</code>, and are inputs for <code>Interactions</code>.</p>
<p>For a <code>Recipe</code> there exist <code>Ingredients</code> which are a name and a <code>Type</code>, they are used to model the data of your process.</p>
<p>For a <code>RecipeInstance</code> there exist <code>IngredientInstance</code>s, which are a name and a <code>Value</code>, they are used to move data 
through your process. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Scala</label><label for="__tabbed_2_2">Java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">recipe</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="nc">Ingredient</span>

<span class="kd">val</span><span class="w"> </span><span class="nc">OrderId</span><span class="p">:</span><span class="w"> </span><span class="nc">Ingredient</span><span class="p">[</span><span class="nc">String</span><span class="p">]</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nc">Ingredient</span><span class="p">[</span><span class="nc">String</span><span class="p">](</span><span class="s">&quot;orderId&quot;</span><span class="p">)</span>


<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="nc">IngredientInstance</span>

<span class="kd">val</span><span class="w"> </span><span class="n">orderIdInstance</span><span class="p">:</span><span class="w"> </span><span class="nc">IngredientInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="nc">IngredientInstance</span><span class="p">(</span><span class="s">&quot;orderId&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">PrimitiveValue</span><span class="p">(</span><span class="s">&quot;uuid-123456789&quot;</span><span class="p">))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// In Java, Ingredients are extracted from a class </span>
<span class="c1">// representing an Event by using java reflection.</span>
<span class="c1">// See the full example at the &quot;Recipe and RecipeInstance&quot; section</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="event-and-eventinstance">Event and EventInstance</h2>
<p><code>Events</code> represent happenings in your process that might carry <code>Ingredients</code>, they represent an "asynchronous boundary",
they are always either output from <code>Interactions</code> or a special case called <code>SensoryEvent</code>s; we call sensory events to the 
events that come from "outside" of your recipe and are normally used to start your process.</p>
<p>For a <code>Recipe</code> there exist <code>Events</code> which are a name, a set of <code>Ingredients</code> and a maximum amount of firings; the 
<code>maxFiringLimit</code> is a property which describes the number of times an event is allowed to fire, this is later on
enforced by the Baker runtime. To know more about firing limits and all the other configurable properties, please 
refer to the <a href="../../reference/dsls/">DSLs documentation</a>.</p>
<p>For a <code>RecipeInstance</code> there exist <code>EventInstance</code>s which are data structures that must match their interface equivalent
declared as <code>Events</code> on the <code>Recipe</code>. They notify a baker <code>RecipeInstance</code> of an actual happening and may carry <code>Ingredient</code>
values; the baker <code>RecipeInstance</code> will then use available <code>Ingredients</code> to execute <code>InteractionInstance</code>s.</p>
<p><strong>Note: Names of sensory <code>Event</code> and <code>EventInstance</code> must match, so that Baker can correctly execute your process flow.</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Scala</label><label for="__tabbed_3_2">Java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="cm">/** Event */</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">recipe</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="nc">Event</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">recipe</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="nc">Ingredient</span>

<span class="kd">val</span><span class="w"> </span><span class="nc">OrderPlaced</span><span class="p">:</span><span class="w"> </span><span class="nc">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Event</span><span class="p">(</span>
<span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;OrderPlaced&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">providedIngredients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">    </span><span class="nc">Ingredient</span><span class="p">[</span><span class="nc">String</span><span class="p">](</span><span class="s">&quot;orderId&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="nc">Ingredient</span><span class="p">[</span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">]](</span><span class="s">&quot;items&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">),</span>
<span class="w">  </span><span class="n">maxFiringLimit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Some</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="cm">/** EventInstance */</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="nc">EventInstance</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">types</span><span class="p">.{</span><span class="nc">PrimitiveValue</span><span class="p">,</span><span class="w"> </span><span class="nc">ListValue</span><span class="p">}</span>

<span class="kd">val</span><span class="w"> </span><span class="n">firstOrderPlaced</span><span class="p">:</span><span class="w"> </span><span class="nc">EventInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EventInstance</span><span class="p">(</span>
<span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;OrderPlaced&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">providedIngredients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;orderId&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">PrimitiveValue</span><span class="p">(</span><span class="s">&quot;uuid-0123456789&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="s">&quot;items&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">ListValue</span><span class="p">(</span><span class="nc">List</span><span class="p">(</span><span class="nc">PrimitiveValue</span><span class="p">(</span><span class="s">&quot;item1-id&quot;</span><span class="p">),</span><span class="w"> </span><span class="nc">PrimitiveValue</span><span class="p">(</span><span class="s">&quot;item2-id&quot;</span><span class="p">)))</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// In Java, Events and EventInstances are extracted from a </span>
<span class="c1">// class by using java reflection.</span>
<span class="c1">// Please check the full recipe example below on the </span>
<span class="c1">// Recipe and RecipeInstance subsection</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.javadsl.EventInstance</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OrderPlaced</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">orderId</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">OrderPlaced</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">orderId</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">orderId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderId</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item2&quot;</span><span class="p">);</span>
<span class="n">OrderPlaced</span><span class="w"> </span><span class="n">order1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderPlaced</span><span class="p">(</span><span class="s">&quot;uuid-0123456789&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>
<span class="n">EventInstance</span><span class="w"> </span><span class="n">order1Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">order1</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>To fire a <code>SensoryEvent</code> use the <code>bakerRuntime.fireEvent(recipeInstanceId, event)</code> API variations, 
after creating the baker runtime, adding your recipe to the runtime and <code>baking</code> a <code>RecipeInstance</code>. For full 
documentation on this please refer to the <a href="../../reference/runtime/">runtime documentation</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Scala</label><label for="__tabbed_4_2">Java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">akka</span><span class="p">.</span><span class="nn">actor</span><span class="p">.</span><span class="nc">ActorSystem</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">common</span><span class="p">.</span><span class="nc">EventResult</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.{</span><span class="nc">Baker</span><span class="p">,</span><span class="w"> </span><span class="nc">EventInstance</span><span class="p">}</span>

<span class="k">import</span><span class="w"> </span><span class="nn">scala</span><span class="p">.</span><span class="nn">concurrent</span><span class="p">.</span><span class="nc">Future</span>

<span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">actorSystem</span><span class="p">:</span><span class="w"> </span><span class="nc">ActorSystem</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nc">ActorSystem</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">baker</span><span class="p">:</span><span class="w"> </span><span class="nc">Baker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">AkkaBaker</span><span class="p">.</span><span class="n">localDefault</span><span class="p">(</span><span class="n">actorSystem</span><span class="p">)</span>

<span class="c1">// This example is using the reflection API `EventInstance.unsafeFrom`</span>
<span class="kd">val</span><span class="w"> </span><span class="nc">FirstOrderPlaced</span><span class="p">:</span><span class="w"> </span><span class="nc">EventInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">EventInstance</span>
<span class="w">    </span><span class="p">.</span><span class="n">unsafeFrom</span><span class="p">(</span><span class="nc">OrderPlaced</span><span class="p">(</span><span class="s">&quot;order-uuid&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;item2&quot;</span><span class="p">)))</span>
<span class="kd">val</span><span class="w"> </span><span class="n">recipeInstanceId</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;recipe id from previously baked recipe instance&quot;</span>

<span class="kd">val</span><span class="w"> </span><span class="n">result</span><span class="p">:</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">EventResult</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="n">fireEventAndResolveWhenCompleted</span><span class="p">(</span><span class="n">recipeInstanceId</span><span class="p">,</span><span class="w"> </span><span class="nc">FirstOrderPlaced</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">akka.actor.ActorSystem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.akka.AkkaBaker</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.javadsl.EventInstance</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.javadsl.EventResult</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.CompletableFuture</span><span class="p">;</span>

<span class="n">ActorSystem</span><span class="w"> </span><span class="n">actorSystem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActorSystem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">);</span>
<span class="n">Baker</span><span class="w"> </span><span class="n">baker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AkkaBaker</span><span class="p">.</span><span class="na">javaLocalDefault</span><span class="p">(</span><span class="n">actorSystem</span><span class="p">);</span>

<span class="n">String</span><span class="w"> </span><span class="n">recipeInstanceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;recipe id from previously baked recipe instance&quot;</span><span class="p">;</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item2&quot;</span><span class="p">);</span>
<span class="n">EventInstance</span><span class="w"> </span><span class="n">firstOrderPlaced</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">OrderPlaced</span><span class="p">(</span><span class="s">&quot;order-uuid&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">));</span>

<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">EventResult</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="na">fireEventAndResolveWhenCompleted</span><span class="p">(</span><span class="n">recipeInstanceId</span><span class="p">,</span><span class="w"> </span><span class="n">firstOrderPlaced</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="interaction-and-interactioninstance">Interaction and InteractionInstance</h2>
<p>An interaction resemblance a function, it requires input (<code>Ingredients</code>) and provides output (<code>Events</code>). Within this
contract it may do anything. For example:</p>
<ul>
<li>Query a microservice</li>
<li>Send messages to an event broker like Kafka</li>
<li>Await for a message from an event broker</li>
<li>Generate a file</li>
<li>Do transformations on the ingredients (we like to call these interactions <code>Sieves</code>)</li>
</ul>
<p>For a <code>Recipe</code> there exist <code>Interactions</code> which are a name, a sequence of <code>Ingredients</code> describing all the input (all of),
and a sequence of <code>Events</code> describing the <em>possible</em> event outputs (one of). At the recipe level there are several more 
specifics that can be configured, like requiring events without ingredients, adding predefined ingredients, overriding
ingredient names, or handling unexpected failure, for these please refer to the <a href="../../reference/dsls/">DSLs documentation</a>.</p>
<p>For a <code>RecipeInstance</code> there exist <code>InteractionInstance</code>s which are a name, an input type description, and an implementation
of a method/function that will be called when the interaction is executed. The input name and the input type description 
is used by the Baker runtime to find the correct <code>InteractionImplementation</code> to execute when the <code>Ingredients</code> are available.</p>
<p><strong>Note: Names of sensory <code>Event</code> and <code>EventInstance</code> must match, so that Baker can correctly execute your process flow.</strong></p>
<p><strong>Note: For asynchronous programming, the Scala DSL <code>InteractionInstance</code> can return a <code>Future[A]</code> and the Java DSL can
return a <code>CompletableFuture&lt;A&gt;</code>, and the Baker runtime will handle the async results of the instances.</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Scala</label><label for="__tabbed_5_2">Java</label><label for="__tabbed_5_3">Scala (Reflection API)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="cm">/** Interaction */</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">recipe</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.{</span><span class="nc">Event</span><span class="p">,</span><span class="w"> </span><span class="nc">Ingredient</span><span class="p">,</span><span class="w"> </span><span class="nc">Interaction</span><span class="p">}</span>

<span class="kd">val</span><span class="w"> </span><span class="nc">ReserveItems</span><span class="p">:</span><span class="w"> </span><span class="nc">Interaction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Interaction</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ReserveItems&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">inputIngredients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">        </span><span class="nc">Ingredient</span><span class="p">[</span><span class="nc">String</span><span class="p">](</span><span class="s">&quot;orderId&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="nc">Ingredient</span><span class="p">[</span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">]](</span><span class="s">&quot;items&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">        </span><span class="nc">Events</span><span class="p">.</span><span class="nc">OrderHadUnavailableItems</span><span class="p">,</span>
<span class="w">        </span><span class="nc">Events</span><span class="p">.</span><span class="nc">ItemsReserved</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">)</span>

<span class="cm">/** InteractionInstance */</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.{</span><span class="nc">EventInstance</span><span class="p">,</span><span class="w"> </span><span class="nc">IngredientInstance</span><span class="p">,</span><span class="w"> </span><span class="nc">InteractionInstance</span><span class="p">}</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">types</span><span class="p">.{</span><span class="nc">CharArray</span><span class="p">,</span><span class="w"> </span><span class="nc">ListType</span><span class="p">,</span><span class="w"> </span><span class="nc">ListValue</span><span class="p">,</span><span class="w"> </span><span class="nc">PrimitiveValue</span><span class="p">}</span>

<span class="k">import</span><span class="w"> </span><span class="nn">scala</span><span class="p">.</span><span class="nn">concurrent</span><span class="p">.</span><span class="nc">Future</span>
<span class="k">import</span><span class="w"> </span><span class="nn">scala</span><span class="p">.</span><span class="nn">concurrent</span><span class="p">.</span><span class="nc">ExecutionContext</span><span class="p">.</span><span class="nc">Implicits</span><span class="p">.</span><span class="n">global</span>

<span class="kd">val</span><span class="w"> </span><span class="nc">ReserveItemsInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">InteractionInstance</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ReserveItems</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span><span class="nc">CharArray</span><span class="p">,</span><span class="w"> </span><span class="nc">ListType</span><span class="p">(</span><span class="nc">CharArray</span><span class="p">))</span>
<span class="w">    </span><span class="n">run</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">handleReserveItems</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">handleReserveItems</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="nc">Seq</span><span class="p">[</span><span class="nc">IngredientInstance</span><span class="p">]):</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">Option</span><span class="p">[</span><span class="nc">EventInstance</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">???</span>
<span class="w">    </span><span class="c1">// ListValue and PrimitiveValue are used in the body</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="cm">/** Interaction */</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.annotations.FiresEvent</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.annotations.RequiresIngredient</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.javadsl.Interaction</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ReserveItems</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Interaction</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">interface</span> <span class="nc">ReserveItemsOutcome</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">class</span> <span class="nc">OrderHadUnavailableItems</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ReserveItemsOutcome</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unavailableItems</span><span class="p">;</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">OrderHadUnavailableItems</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unavailableItems</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">unavailableItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unavailableItems</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">class</span> <span class="nc">ItemsReserved</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ReserveItemsOutcome</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">reservedItems</span><span class="p">;</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">ItemsReserved</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">reservedItems</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">reservedItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reservedItems</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Annotations are needed for wiring ingredients and validating events.</span>
<span class="w">    </span><span class="nd">@FiresEvent</span><span class="p">(</span><span class="n">oneOf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">OrderHadUnavailableItems</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">ItemsReserved</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="w">    </span><span class="c1">// The name of the method must be &quot;apply&quot; for the reflection API to work.</span>
<span class="w">    </span><span class="c1">// This method can also return a `CompletableFuture&lt;ReserveItemsOutcome&gt;` for asynchronous programming.</span>
<span class="w">    </span><span class="n">ReserveItemsOutcome</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="nd">@RequiresIngredient</span><span class="p">(</span><span class="s">&quot;orderId&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="nd">@RequiresIngredient</span><span class="p">(</span><span class="s">&quot;items&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/** InteractionInstance */</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.javadsl.InteractionInstance</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ReserveItems</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">ReserveItems</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ReserveItemsOutcome</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">ReserveItems</span><span class="p">.</span><span class="na">ItemsReserved</span><span class="p">(</span><span class="n">items</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// See the DSLs documentation for more on the reflection API</span>
<span class="k">trait</span><span class="w"> </span><span class="nc">ReserveItems</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">orderId</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">]):</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">WebshopRecipeReflection</span><span class="p">.</span><span class="nc">ReserveItemsOutput</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ReserveItemsInstance</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">ReserveItems</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">override</span><span class="w"> </span><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">orderId</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">]):</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">WebshopRecipeReflection</span><span class="p">.</span><span class="nc">ReserveItemsOutput</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// Http call to the Warehouse service</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">response</span><span class="p">:</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">Either</span><span class="p">[</span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">],</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">]]]</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="c1">// This is mocked for the sake of the example</span>
<span class="w">      </span><span class="nc">Future</span><span class="p">.</span><span class="n">successful</span><span class="p">(</span><span class="nc">Right</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>

<span class="w">    </span><span class="c1">// Build an event instance that Baker understands</span>
<span class="w">    </span><span class="n">response</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="nc">Left</span><span class="p">(</span><span class="n">unavailableItems</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="nc">WebshopRecipeReflection</span><span class="p">.</span><span class="nc">OrderHadUnavailableItems</span><span class="p">(</span><span class="n">unavailableItems</span><span class="p">)</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="nc">Right</span><span class="p">(</span><span class="n">reservedItems</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="nc">WebshopRecipeReflection</span><span class="p">.</span><span class="nc">ItemsReserved</span><span class="p">(</span><span class="n">reservedItems</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">val</span><span class="w"> </span><span class="n">reserveItemsInstance</span><span class="p">:</span><span class="w"> </span><span class="nc">InteractionInstance</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="nc">InteractionInstance</span><span class="p">.</span><span class="n">unsafeFrom</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="nc">ReserveItemsInstance</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>After creating your <code>InteractionInstance</code>s, you need to add them to the baker runtime so that Baker can match them to the <code>Interactions</code>
of your <code>Recipe</code> and call them when needed.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Scala</label><label for="__tabbed_6_2">Java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">akka</span><span class="p">.</span><span class="nn">actor</span><span class="p">.</span><span class="nc">ActorSystem</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="nc">Baker</span>

<span class="k">import</span><span class="w"> </span><span class="nn">scala</span><span class="p">.</span><span class="nn">concurrent</span><span class="p">.</span><span class="nc">Future</span>

<span class="kd">val</span><span class="w"> </span><span class="n">done</span><span class="p">:</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">Unit</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="n">addInteractionInstance</span><span class="p">(</span><span class="n">reserveItemsInstance</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">akka.actor.ActorSystem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.akka.AkkaBaker</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">scala.runtime.BoxedUnit</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.CompletableFuture</span><span class="p">;</span>

<span class="n">ActorSystem</span><span class="w"> </span><span class="n">actorSystem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActorSystem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">);</span>
<span class="n">Baker</span><span class="w"> </span><span class="n">baker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AkkaBaker</span><span class="p">.</span><span class="na">javaLocalDefault</span><span class="p">(</span><span class="n">actorSystem</span><span class="p">);</span>

<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">BoxedUnit</span><span class="o">&gt;</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="na">addInteractionInstance</span><span class="p">(</span><span class="n">reserveItemsInstance</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="recipe-and-recipeinstance">Recipe and RecipeInstance</h2>
<p>All you <code>Ingredients</code>, <code>Events</code> and <code>Interactions</code> must be added to a single unit called the <code>Recipe</code>, which works as the
"blueprint" of your precess.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:4"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><input id="__tabbed_7_3" name="__tabbed_7" type="radio" /><input id="__tabbed_7_4" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Scala</label><label for="__tabbed_7_2">Scala Full Example</label><label for="__tabbed_7_3">Java</label><label for="__tabbed_7_4">Java Full Example</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">recipe</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="nc">Recipe</span>

<span class="kd">val</span><span class="w"> </span><span class="n">recipe</span><span class="p">:</span><span class="w"> </span><span class="nc">Recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Recipe</span><span class="p">(</span><span class="s">&quot;Webshop&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">withSensoryEvents</span><span class="p">(</span>
<span class="w">        </span><span class="nc">Events</span><span class="p">.</span><span class="nc">OrderPlaced</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">withInteractions</span><span class="p">(</span>
<span class="w">        </span><span class="nc">Interactions</span><span class="p">.</span><span class="nc">ReserveItems</span><span class="p">,</span>
<span class="w">    </span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="n">webshop</span>

<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">recipe</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.{</span><span class="nc">Event</span><span class="p">,</span><span class="w"> </span><span class="nc">Ingredient</span><span class="p">,</span><span class="w"> </span><span class="nc">Interaction</span><span class="p">,</span><span class="w"> </span><span class="nc">Recipe</span><span class="p">}</span>

<span class="k">object</span><span class="w"> </span><span class="nc">WebshopRecipeReflection</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">OrderPlaced</span><span class="p">(</span><span class="n">orderId</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">])</span>

<span class="w">  </span><span class="k">sealed</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="nc">ReserveItemsOutput</span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">OrderHadUnavailableItems</span><span class="p">(</span><span class="n">unavailableItems</span><span class="p">:</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">])</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">ReserveItemsOutput</span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ItemsReserved</span><span class="p">(</span><span class="n">reservedItems</span><span class="p">:</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">])</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">ReserveItemsOutput</span>

<span class="w">  </span><span class="kd">val</span><span class="w"> </span><span class="nc">ReserveItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Interaction</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ReserveItems&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">inputIngredients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">      </span><span class="nc">Ingredient</span><span class="p">[</span><span class="nc">String</span><span class="p">](</span><span class="s">&quot;orderId&quot;</span><span class="p">),</span>
<span class="w">      </span><span class="nc">Ingredient</span><span class="p">[</span><span class="nc">List</span><span class="p">[</span><span class="nc">String</span><span class="p">]](</span><span class="s">&quot;items&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">      </span><span class="nc">Event</span><span class="p">[</span><span class="nc">OrderHadUnavailableItems</span><span class="p">],</span>
<span class="w">      </span><span class="nc">Event</span><span class="p">[</span><span class="nc">ItemsReserved</span><span class="p">]</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>

<span class="w">  </span><span class="kd">val</span><span class="w"> </span><span class="n">recipe</span><span class="p">:</span><span class="w"> </span><span class="nc">Recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Recipe</span><span class="p">(</span><span class="s">&quot;Webshop&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">withSensoryEvents</span><span class="p">(</span>
<span class="w">      </span><span class="nc">Event</span><span class="p">[</span><span class="nc">OrderPlaced</span><span class="p">],</span>
<span class="w">      </span><span class="nc">Event</span><span class="p">[</span><span class="nc">OrderHadUnavailableItems</span><span class="p">],</span>
<span class="w">      </span><span class="nc">Event</span><span class="p">[</span><span class="nc">ItemsReserved</span><span class="p">]</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">withInteractions</span><span class="p">(</span>
<span class="w">      </span><span class="nc">ReserveItems</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.javadsl.Recipe</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.javadsl.InteractionDescriptor.of</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Recipe</span><span class="w"> </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Recipe</span><span class="p">(</span><span class="s">&quot;WebshopRecipe&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">withSensoryEvents</span><span class="p">(</span><span class="n">OrderPlaced</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">withInteractions</span><span class="p">(</span><span class="n">of</span><span class="p">(</span><span class="n">ReserveItems</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">webshop</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.annotations.FiresEvent</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.annotations.RequiresIngredient</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.javadsl.Interaction</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.javadsl.Recipe</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">com.ing.baker.recipe.javadsl.InteractionDescriptor.of</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JWebshopRecipe</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OrderPlaced</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">orderId</span><span class="p">;</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">;</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">OrderPlaced</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">orderId</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">orderId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderId</span><span class="p">;</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ReserveItems</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Interaction</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kd">interface</span> <span class="nc">ReserveItemsOutcome</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">class</span> <span class="nc">OrderHadUnavailableItems</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ReserveItemsOutcome</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unavailableItems</span><span class="p">;</span>

<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="nf">OrderHadUnavailableItems</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unavailableItems</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">unavailableItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unavailableItems</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">class</span> <span class="nc">ItemsReserved</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ReserveItemsOutcome</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">reservedItems</span><span class="p">;</span>

<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="nf">ItemsReserved</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">reservedItems</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">reservedItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reservedItems</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@FiresEvent</span><span class="p">(</span><span class="n">oneOf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">OrderHadUnavailableItems</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">ItemsReserved</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="w">        </span><span class="n">ReserveItemsOutcome</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="nd">@RequiresIngredient</span><span class="p">(</span><span class="s">&quot;orderId&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="nd">@RequiresIngredient</span><span class="p">(</span><span class="s">&quot;items&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Recipe</span><span class="w"> </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Recipe</span><span class="p">(</span><span class="s">&quot;WebshopRecipe&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">withSensoryEvents</span><span class="p">(</span><span class="n">OrderPlaced</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">withInteractions</span><span class="p">(</span><span class="n">of</span><span class="p">(</span><span class="n">ReserveItems</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>A recipe must be added to a baker runtime so that you can create "bake" a <code>RecipeInstance</code> from it. For that it must be
first "compiled" by using the provided compiler.</p>
<p>Here is a full example of creating a baker runtime, adding the <code>InteractionInstances</code> and the compiled <code>Recipe</code> (order matters
becase baker validates that all recipes have valid implementations when added), and firing an <code>Event</code> that will execute 
the <code>Interaction</code></p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Scala</label><label for="__tabbed_8_2">Java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">akka</span><span class="p">.</span><span class="nn">actor</span><span class="p">.</span><span class="nc">ActorSystem</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">compiler</span><span class="p">.</span><span class="nc">RecipeCompiler</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">il</span><span class="p">.</span><span class="nc">CompiledRecipe</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="nc">EventInstance</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">akka</span><span class="p">.</span><span class="nc">AkkaBaker</span>

<span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">actorSystem</span><span class="p">:</span><span class="w"> </span><span class="nc">ActorSystem</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nc">ActorSystem</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">baker</span><span class="p">:</span><span class="w"> </span><span class="nc">Baker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">AkkaBaker</span><span class="p">.</span><span class="n">localDefault</span><span class="p">(</span><span class="n">actorSystem</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="n">compiledRecipe</span><span class="p">:</span><span class="w"> </span><span class="nc">CompiledRecipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">RecipeCompiler</span><span class="p">.</span><span class="n">compileRecipe</span><span class="p">(</span><span class="nc">WebshopRecipe</span><span class="p">.</span><span class="n">recipe</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="n">program</span><span class="p">:</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">Unit</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="n">addInteractionInstance</span><span class="p">(</span><span class="nc">WebshopInstances</span><span class="p">.</span><span class="nc">ReserveItemsInstance</span><span class="p">)</span>
<span class="w">    </span><span class="n">recipeId</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="n">addRecipe</span><span class="p">(</span><span class="nc">RecipeRecord</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">compiledRecipe</span><span class="p">))</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="n">bake</span><span class="p">(</span><span class="n">recipeId</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;first-instance-id&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">firstOrderPlaced</span><span class="p">:</span><span class="w"> </span><span class="nc">EventInstance</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="nc">EventInstance</span><span class="p">.</span><span class="n">unsafeFrom</span><span class="p">(</span><span class="nc">WebshopRecipeReflection</span><span class="p">.</span><span class="nc">OrderPlaced</span><span class="p">(</span><span class="s">&quot;order-uuid&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;item2&quot;</span><span class="p">)))</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="n">fireEventAndResolveWhenCompleted</span><span class="p">(</span><span class="s">&quot;first-instance-id&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">firstOrderPlaced</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="n">assert</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">events</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">    </span><span class="nc">WebshopRecipe</span><span class="p">.</span><span class="nc">Events</span><span class="p">.</span><span class="nc">OrderPlaced</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="nc">WebshopRecipe</span><span class="p">.</span><span class="nc">Events</span><span class="p">.</span><span class="nc">ItemsReserved</span><span class="p">.</span><span class="n">name</span>
<span class="p">))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">akka.actor.ActorSystem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.compiler.RecipeCompiler</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.il.CompiledRecipe</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.akka.AkkaBaker</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.javadsl.EventInstance</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.javadsl.EventResult</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.javadsl.InteractionInstance</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.CompletableFuture</span><span class="p">;</span>


<span class="n">ActorSystem</span><span class="w"> </span><span class="n">actorSystem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActorSystem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">);</span>
<span class="n">Baker</span><span class="w"> </span><span class="n">baker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AkkaBaker</span><span class="p">.</span><span class="na">javaLocalDefault</span><span class="p">(</span><span class="n">actorSystem</span><span class="p">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">);</span>
<span class="n">items</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;item2&quot;</span><span class="p">);</span>
<span class="n">EventInstance</span><span class="w"> </span><span class="n">firstOrderPlaced</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">OrderPlaced</span><span class="p">(</span><span class="s">&quot;order-uuid&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">));</span>

<span class="n">InteractionInstance</span><span class="w"> </span><span class="n">reserveItemsInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InteractionInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ReserveItems</span><span class="p">());</span>
<span class="n">CompiledRecipe</span><span class="w"> </span><span class="n">compiledRecipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RecipeCompiler</span><span class="p">.</span><span class="na">compileRecipe</span><span class="p">(</span><span class="n">JWebshopRecipe</span><span class="p">.</span><span class="na">recipe</span><span class="p">);</span>

<span class="n">String</span><span class="w"> </span><span class="n">recipeInstanceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;first-instance-id&quot;</span><span class="p">;</span>
<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="na">addInteractionInstance</span><span class="p">(</span><span class="n">reserveItemsInstance</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">thenCompose</span><span class="p">(</span><span class="n">ignore</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="na">addRecipe</span><span class="p">(</span><span class="n">RecipeRecord</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">compiledRecipe</span><span class="p">)))</span>
<span class="w">    </span><span class="p">.</span><span class="na">thenCompose</span><span class="p">(</span><span class="n">recipeId</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="na">bake</span><span class="p">(</span><span class="n">recipeId</span><span class="p">,</span><span class="w"> </span><span class="n">recipeInstanceId</span><span class="p">))</span>
<span class="w">    </span><span class="p">.</span><span class="na">thenCompose</span><span class="p">(</span><span class="n">ignore</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="na">fireEventAndResolveWhenCompleted</span><span class="p">(</span><span class="n">recipeInstanceId</span><span class="p">,</span><span class="w"> </span><span class="n">firstOrderPlaced</span><span class="p">))</span>
<span class="w">    </span><span class="p">.</span><span class="na">thenApply</span><span class="p">(</span><span class="n">EventResult</span><span class="p">::</span><span class="n">events</span><span class="p">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">blockedResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">join</span><span class="p">();</span>
<span class="k">assert</span><span class="p">(</span><span class="n">blockedResult</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;OrderPlaced&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">blockedResult</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;ReservedItems&quot;</span><span class="p">));</span>
</code></pre></div>
</div>
</div>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>