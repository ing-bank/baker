



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Design a Recipe - Baker</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/ing.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#design-a-recipe" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Baker" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Baker
            </span>
            <span class="md-header-nav__topic">
              
                Design a Recipe
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ing-bank/baker/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Baker" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Baker
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ing-bank/baker/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Development Life Cycle
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Development Life Cycle
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Design a Recipe
      </label>
    
    <a href="./" title="Design a Recipe" class="md-nav__link md-nav__link--active">
      Design a Recipe
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modeling-the-order-placement-process-for-a-webshop-using-ingredients-events-and-recipes" title="Modeling the order placement process for a webshop using Ingredients, Events and Recipes." class="md-nav__link">
    Modeling the order placement process for a webshop using Ingredients, Events and Recipes.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingredients-and-events" title="Ingredients and Events" class="md-nav__link">
    Ingredients and Events
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactions" title="Interactions" class="md-nav__link">
    Interactions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-recipe" title="The Recipe" class="md-nav__link">
    The Recipe
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../use-visualizations/" title="Use Visualizations" class="md-nav__link">
      Use Visualizations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implement-interactions/" title="Implement Interactions" class="md-nav__link">
      Implement Interactions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bake-fire-events-and-inquiry/" title="Bake, Fire Events and Inquiry" class="md-nav__link">
      Bake, Fire Events and Inquiry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../test/" title="Test" class="md-nav__link">
      Test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configure/" title="Configure" class="md-nav__link">
      Configure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../monitor/" title="Monitor" class="md-nav__link">
      Monitor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../resolve-failed-recipe-instances/" title="Resolve Failed Recipes" class="md-nav__link">
      Resolve Failed Recipes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/main-abstractions/" title="Main Abstractions" class="md-nav__link">
      Main Abstractions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/execution-semantics/" title="Execution Semantics" class="md-nav__link">
      Execution Semantics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/baker-types-and-values/" title="Baker Types and Values" class="md-nav__link">
      Baker Types and Values
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/dsls/" title="Recipe DSLs" class="md-nav__link">
      Recipe DSLs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/runtime/" title="The Akka Based Runtime" class="md-nav__link">
      The Akka Based Runtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/event-listener/" title="Event Listener" class="md-nav__link">
      Event Listener
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/stores/" title="Event Stores and Cluster Configuration" class="md-nav__link">
      Event Stores and Cluster Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Versions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Versions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../versions/baker-3/" title="Migration Guide v3" class="md-nav__link">
      Migration Guide v3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../versions/baker-2/" title="Migration Guide v2" class="md-nav__link">
      Migration Guide v2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../feature-comparison/" title="Feature comparison" class="md-nav__link">
      Feature comparison
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modeling-the-order-placement-process-for-a-webshop-using-ingredients-events-and-recipes" title="Modeling the order placement process for a webshop using Ingredients, Events and Recipes." class="md-nav__link">
    Modeling the order placement process for a webshop using Ingredients, Events and Recipes.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingredients-and-events" title="Ingredients and Events" class="md-nav__link">
    Ingredients and Events
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactions" title="Interactions" class="md-nav__link">
    Interactions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-recipe" title="The Recipe" class="md-nav__link">
    The Recipe
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ing-bank/baker/edit/master/docs/sections/development-life-cycle/design-a-recipe.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="design-a-recipe">Design a Recipe</h1>
<p><em>Full project examples including tests and configuration can be found <a href="https://github.com/ing-bank/baker/tree/master/examples">here</a>.</em></p>
<p>The <em>Development Life Cycle</em> section provides a "top-down"/"by-example" guide to baker, all of the concepts 
are introduced through exemplification on hypothetical development situations.</p>
<h2 id="modeling-the-order-placement-process-for-a-webshop-using-ingredients-events-and-recipes">Modeling the order placement process for a webshop using Ingredients, Events and Recipes.</h2>
<p>The recipe DSL allows you to declaratively describe your business process. The design always starts with the
business requirements, lets say you are developing a webshop which will have many different microservices on 
the backend. The initial requirements for the order reservation process reads: </p>
<p><em>"An order contains an order id and a list of store item identifiers, when an order is placed it must first 
be validated by reserving the items from the warehouse service, a success scenario yields the ids of the 
reserved items, but if at least one item is unavailable at the warehouse a failure yields the list of unavailable items 
and the process stops"</em></p>
<p>When developing with Baker we must first translate the requirements into our 3 essential building blocks, 
<code>Ingredients</code> for raw data, <code>Events</code> for happenings (that might contain ingredients), and <code>Interactions</code> which 
have ingredients as input, execute actions with other systems, and yield more events. We will do this so that the 
baker runtime can orchestrate the execution of our process through the underlying microservices.</p>
<h2 id="ingredients-and-events">Ingredients and Events</h2>
<p>A recipe always starts with initial events, also called <code>Sensory Events</code>, in the case of our first requirement 
we could model the placing of an order as an event, which will provide 2 ingredients: the order id and the list
of items.</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">Scala</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">com.ing.baker.recipe.scaladsl._</span>

<span class="k">object</span> <span class="nc">Ingredients</span> <span class="o">{</span>

    <span class="k">val</span> <span class="nc">OrderId</span><span class="k">:</span> <span class="kt">Ingredient</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
      <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;orderId&quot;</span><span class="o">)</span>

    <span class="k">val</span> <span class="nc">Items</span><span class="k">:</span> <span class="kt">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span>
      <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]](</span><span class="s">&quot;items&quot;</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Events</span> <span class="o">{</span>

    <span class="k">val</span> <span class="nc">OrderPlaced</span><span class="k">:</span> <span class="kt">Event</span> <span class="o">=</span> <span class="nc">Event</span><span class="o">(</span>
      <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;OrderPlaced&quot;</span><span class="o">,</span>
      <span class="n">providedIngredients</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
        <span class="nc">Ingredients</span><span class="o">.</span><span class="nc">OrderId</span><span class="o">,</span>
        <span class="nc">Ingredients</span><span class="o">.</span><span class="nc">Items</span>
      <span class="o">),</span>
      <span class="n">maxFiringLimit</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="o">)</span>
<span class="o">}</span>
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">Java</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="c1">// In Java the data structures to represent Events and Ingredients </span>
<span class="c1">// will be extraxted from a class by the reflection API when building </span>
<span class="c1">// the Recipe. (see below for full example)</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JWebshopRecipe</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">OrderPlaced</span> <span class="o">{</span>

        <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">orderId</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">OrderPlaced</span><span class="o">(</span><span class="n">String</span> <span class="n">orderId</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">orderId</span> <span class="o">=</span> <span class="n">orderId</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div></div>
</div>
<p>Depending on your programming language, you might want to import the corresponding dsl, i.e. <code>scaladsl</code> vs <code>javadsl</code>.</p>
<p>Ingredients and events are just data structures that describe your process data, carrying not just the names, but
also the type information, for example <code>Ingredient[String]("order-id")</code> creates an ingredient of name "order-id"
of type "String", for more information about Baker types please refer to <a href="../../reference/baker-types-and-values/">this section</a>.
As shown in the code, events might carry ingredients, and have a maximum about of times they are allowed to fire, the 
runtime will enforce this limit. For more information about this and other features of events please refer to <a href="../../reference/dsls/#events">this section</a>.</p>
<h2 id="interactions">Interactions</h2>
<p>Then, the desired actions can be modeled as <code>interactions</code>, in our case we are told that it exists a warehouse service 
which we need to call to reserve the items, but this might either succeed or fail.</p>
<p><em>Note: Notice that when using the reflection API, the Java interface or Scala trait that will represent your interaction
must have a method named <code>apply</code>, this is the method that the reflection API will convert into Baker types/ingredients/events.</em></p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">Scala</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">object</span> <span class="nc">Interactions</span> <span class="o">{</span>

    <span class="k">val</span> <span class="nc">ReserveItems</span><span class="k">:</span> <span class="kt">Interaction</span> <span class="o">=</span> <span class="nc">Interaction</span><span class="o">(</span>
          <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;ReserveItems&quot;</span><span class="o">,</span>
          <span class="n">inputIngredients</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
            <span class="nc">Ingredients</span><span class="o">.</span><span class="nc">OrderId</span><span class="o">,</span>
            <span class="nc">Ingredients</span><span class="o">.</span><span class="nc">Items</span><span class="o">,</span>
          <span class="o">),</span>
          <span class="n">output</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
            <span class="nc">Events</span><span class="o">.</span><span class="nc">OrderHadMissingItems</span><span class="o">,</span>
            <span class="nc">Events</span><span class="o">.</span><span class="nc">ItemsReserved</span>
          <span class="o">)</span>
        <span class="o">)</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Ingredients</span> <span class="o">{</span>

    <span class="c1">// ... previous ingredients</span>

    <span class="k">val</span> <span class="nc">ReservedItems</span><span class="k">:</span> <span class="kt">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span>
      <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]](</span><span class="s">&quot;reservedItems&quot;</span><span class="o">)</span>

    <span class="k">val</span> <span class="nc">UnavailableItems</span><span class="k">:</span> <span class="kt">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span>
      <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]](</span><span class="s">&quot;unavailableItems&quot;</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Events</span> <span class="o">{</span>

    <span class="c1">// ... previous events</span>

    <span class="k">val</span> <span class="nc">OrderHadUnavailableItems</span><span class="k">:</span> <span class="kt">Event</span> <span class="o">=</span> <span class="nc">Event</span><span class="o">(</span>
      <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;OrderHadUnavailableItems&quot;</span><span class="o">,</span>
      <span class="n">providedIngredients</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
        <span class="nc">Ingredients</span><span class="o">.</span><span class="nc">UnavailableItems</span>
      <span class="o">),</span>
      <span class="n">maxFiringLimit</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="o">)</span>

    <span class="k">val</span> <span class="nc">ItemsReserved</span><span class="k">:</span> <span class="kt">Event</span> <span class="o">=</span> <span class="nc">Event</span><span class="o">(</span>
      <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;ItemsReserved&quot;</span><span class="o">,</span>
      <span class="n">providedIngredients</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
        <span class="nc">Ingredients</span><span class="o">.</span><span class="nc">ReservedItems</span>
      <span class="o">),</span>
      <span class="n">maxFiringLimit</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="o">)</span>
<span class="o">}</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">Java (Reflection API)</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">public</span> <span class="k">class</span> <span class="nc">JWebshopRecipe</span> <span class="o">{</span>

    <span class="c1">// ... previous event</span>

    <span class="c1">// Interface that will represent our Interaction, notice that it is declaring inner events.</span>

    <span class="n">public</span> <span class="n">interface</span> <span class="nc">ReserveItems</span> <span class="k">extends</span> <span class="nc">Interaction</span> <span class="o">{</span>

        <span class="n">interface</span> <span class="nc">ReserveItemsOutcome</span> <span class="o">{</span>
        <span class="o">}</span>

        <span class="k">class</span> <span class="nc">OrderHadUnavailableItems</span> <span class="n">implements</span> <span class="nc">ReserveItemsOutcome</span> <span class="o">{</span>

            <span class="n">public</span> <span class="k">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">unavailableItems</span><span class="o">;</span>

            <span class="n">public</span> <span class="nc">OrderHadUnavailableItems</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">unavailableItems</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="n">unavailableItems</span> <span class="k">=</span> <span class="n">unavailableItems</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">class</span> <span class="nc">ItemsReserved</span> <span class="n">implements</span> <span class="nc">ReserveItemsOutcome</span> <span class="o">{</span>

            <span class="n">public</span> <span class="k">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">reservedItems</span><span class="o">;</span>

            <span class="n">public</span> <span class="nc">ItemsReserved</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">reservedItems</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="n">reservedItems</span> <span class="k">=</span> <span class="n">reservedItems</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="c1">// The @FireEvent annotation communicates the reflection API about several possible outcome events.</span>
        <span class="nd">@FiresEvent</span><span class="o">(</span><span class="n">oneOf</span> <span class="k">=</span> <span class="o">{</span><span class="nc">OrderHadUnavailableItems</span><span class="o">.</span><span class="n">class</span><span class="o">,</span> <span class="nc">ItemsReserved</span><span class="o">.</span><span class="n">class</span><span class="o">})</span>
        <span class="c1">// The @RequiresIngredient annotation communicates the reflection API about the ingredient names that other events</span>
        <span class="c1">// must provide to execute this interaction.</span>
        <span class="c1">// The method MUST be named `apply`</span>
        <span class="nc">ReserveItemsOutcome</span> <span class="n">apply</span><span class="o">(</span><span class="nd">@RequiresIngredient</span><span class="o">(</span><span class="s">&quot;orderId&quot;</span><span class="o">)</span> <span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="nd">@RequiresIngredient</span><span class="o">(</span><span class="s">&quot;items&quot;</span><span class="o">)</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div></div>
</div>
<p>An interaction resembles a function, it takes input ingredients and outputs 1 of several possible events. At runtime, when
an event fires, baker tries to match the provided ingredients of 1 or several events to the input of awaiting interactions,
as soon as there is a match on data, baker will execute the interactions, creating a cascading effect that will execute
your business process in an asynchronous manner.</p>
<p>This was a simple example, but you might have already concluded that this can be further composed into bigger processes by
making new interactions that require events and ingredients which are output of previous interactions. </p>
<p>You can create also interactions which take no input ingredients but are executed after events (with or without provided 
ingredients) are fired, for this and other features please refer to the conceptual documentation found <a href="../../reference/dsls/#events">here</a>.</p>
<h2 id="the-recipe">The Recipe</h2>
<p>The final step is to create an object that will hold all of these descriptions into what we call a Recipe, this becomes
the "blueprint" of your process, it can define failure handling strategies, and will "auto-bind" the interactions, that 
means it detects the composition between interactions by matching the ingredients provided by events to the input ingredients
required by interactions.</p>
<div class="superfences-tabs">
<input name="__tabs_3" type="radio" id="__tab_3_0" checked="checked" />
<label for="__tab_3_0">Scala</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">object</span> <span class="nc">WebshopRecipe</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">recipe</span><span class="k">:</span> <span class="kt">Recipe</span> <span class="o">=</span> <span class="nc">Recipe</span><span class="o">(</span><span class="s">&quot;Webshop&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">withSensoryEvents</span><span class="o">(</span>
      <span class="nc">Events</span><span class="o">.</span><span class="nc">OrderPlaced</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="n">withInteractions</span><span class="o">(</span>
      <span class="nc">Interactions</span><span class="o">.</span><span class="nc">ReserveItems</span><span class="o">,</span>
    <span class="o">)</span>
<span class="o">}</span>
</pre></div></div>
<input name="__tabs_3" type="radio" id="__tab_3_1" />
<label for="__tab_3_1">Java</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">public</span> <span class="k">class</span> <span class="nc">JWebshopRecipe</span> <span class="o">{</span>

    <span class="c1">// ... previous events and interactions.</span>

    <span class="n">public</span> <span class="k">final</span> <span class="n">static</span> <span class="nc">Recipe</span> <span class="n">recipe</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Recipe</span><span class="o">(</span><span class="s">&quot;WebshopRecipe&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="n">withSensoryEvents</span><span class="o">(</span><span class="nc">OrderPlaced</span><span class="o">.</span><span class="n">class</span><span class="o">)</span>
            <span class="o">.</span><span class="n">withInteractions</span><span class="o">(</span><span class="n">of</span><span class="o">(</span><span class="nc">ReserveItems</span><span class="o">.</span><span class="n">class</span><span class="o">));</span>
<span class="o">}</span>
</pre></div></div>
</div>
<p>Let us remember that this is just a <em>description</em> of what our program across multiple services should do, on the next 
sections we will see how to visualize it, create runtime <code>instances</code> of our recipes and their parts, what common practices
are there for testing, everything you need to know to deploy and monitor a baker cluster, and how Baker helps you handle
and resolve failure which is not modeled in the domain (in the recipe).</p>
<p>As you might have realised <code>Ingredients</code>, <code>Events</code> and <code>Interactions</code> could be reused on different Recipes, giving common
business verbs that your programs and organisation can use across teams, the same way different cooking recipes share
same processes (simmering, boiling, cutting) you should reuse interactions across your different business recipes.</p>
<p>As a bonus; you might have though that this API is verbose, we agree and that is why we developed an alternative 
API which uses Java and Scala reflection.</p>
<div class="superfences-tabs">
<input name="__tabs_4" type="radio" id="__tab_4_0" checked="checked" />
<label for="__tab_4_0">Scala (Reflection API)</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">package</span> <span class="nn">webshop</span>

<span class="k">import</span> <span class="nn">com.ing.baker.recipe.scaladsl.</span><span class="o">{</span><span class="nc">Event</span><span class="o">,</span> <span class="nc">Ingredient</span><span class="o">,</span> <span class="nc">Interaction</span><span class="o">,</span> <span class="nc">Recipe</span><span class="o">}</span>

<span class="k">object</span> <span class="nc">WebshopRecipeReflection</span> <span class="o">{</span>

  <span class="k">case</span> <span class="k">class</span> <span class="nc">OrderPlaced</span><span class="o">(</span><span class="n">orderId</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">items</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span>

  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">ReserveItemsOutput</span>

  <span class="k">case</span> <span class="k">class</span> <span class="nc">OrderHadUnavailableItems</span><span class="o">(</span><span class="n">unavailableItems</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">ReserveItemsOutput</span>

  <span class="k">case</span> <span class="k">class</span> <span class="nc">ItemsReserved</span><span class="o">(</span><span class="n">reservedItems</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">ReserveItemsOutput</span>

  <span class="k">val</span> <span class="nc">ReserveItems</span> <span class="k">=</span> <span class="nc">Interaction</span><span class="o">(</span>
    <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;ReserveItems&quot;</span><span class="o">,</span>
    <span class="n">inputIngredients</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;orderId&quot;</span><span class="o">),</span>
      <span class="nc">Ingredient</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]](</span><span class="s">&quot;items&quot;</span><span class="o">)</span>
    <span class="o">),</span>
    <span class="n">output</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="nc">Event</span><span class="o">[</span><span class="kt">OrderHadUnavailableItems</span><span class="o">],</span>
      <span class="nc">Event</span><span class="o">[</span><span class="kt">ItemsReserved</span><span class="o">]</span>
    <span class="o">)</span>
  <span class="o">)</span>

  <span class="k">val</span> <span class="n">recipe</span><span class="k">:</span> <span class="kt">Recipe</span> <span class="o">=</span> <span class="nc">Recipe</span><span class="o">(</span><span class="s">&quot;Webshop&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">withSensoryEvents</span><span class="o">(</span>
      <span class="nc">Event</span><span class="o">[</span><span class="kt">OrderPlaced</span><span class="o">])</span>
    <span class="o">.</span><span class="n">withInteractions</span><span class="o">(</span>
      <span class="nc">ReserveItems</span><span class="o">)</span>
<span class="o">}</span>
</pre></div></div>
<input name="__tabs_4" type="radio" id="__tab_4_1" />
<label for="__tab_4_1">Java (Reflection API)</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">package</span> <span class="nn">webshop</span><span class="o">;</span>

<span class="k">import</span> <span class="nn">com.ing.baker.recipe.annotations.FiresEvent</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">com.ing.baker.recipe.annotations.RequiresIngredient</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">com.ing.baker.recipe.javadsl.Interaction</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">com.ing.baker.recipe.javadsl.Recipe</span><span class="o">;</span>

<span class="k">import</span> <span class="nn">static</span> <span class="n">com</span><span class="o">.</span><span class="n">ing</span><span class="o">.</span><span class="n">baker</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">javadsl</span><span class="o">.</span><span class="nc">InteractionDescriptor</span><span class="o">.</span><span class="n">of</span><span class="o">;</span>

<span class="n">public</span> <span class="k">class</span> <span class="nc">JWebshopRecipe</span> <span class="o">{</span>

    <span class="n">public</span> <span class="n">static</span> <span class="k">class</span> <span class="nc">OrderPlaced</span> <span class="o">{</span>

        <span class="n">public</span> <span class="k">final</span> <span class="nc">String</span> <span class="n">orderId</span><span class="o">;</span>
        <span class="n">public</span> <span class="k">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">;</span>

        <span class="n">public</span> <span class="nc">OrderPlaced</span><span class="o">(</span><span class="nc">String</span> <span class="n">orderId</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="n">orderId</span> <span class="k">=</span> <span class="n">orderId</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="n">items</span> <span class="k">=</span> <span class="n">items</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="n">public</span> <span class="n">interface</span> <span class="nc">ReserveItems</span> <span class="k">extends</span> <span class="nc">Interaction</span> <span class="o">{</span>

        <span class="n">interface</span> <span class="nc">ReserveItemsOutcome</span> <span class="o">{</span>
        <span class="o">}</span>

        <span class="k">class</span> <span class="nc">OrderHadUnavailableItems</span> <span class="n">implements</span> <span class="nc">ReserveItemsOutcome</span> <span class="o">{</span>

            <span class="n">public</span> <span class="k">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">unavailableItems</span><span class="o">;</span>

            <span class="n">public</span> <span class="nc">OrderHadUnavailableItems</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">unavailableItems</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="n">unavailableItems</span> <span class="k">=</span> <span class="n">unavailableItems</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">class</span> <span class="nc">ItemsReserved</span> <span class="n">implements</span> <span class="nc">ReserveItemsOutcome</span> <span class="o">{</span>

            <span class="n">public</span> <span class="k">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">reservedItems</span><span class="o">;</span>

            <span class="n">public</span> <span class="nc">ItemsReserved</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">reservedItems</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">this</span><span class="o">.</span><span class="n">reservedItems</span> <span class="k">=</span> <span class="n">reservedItems</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="c1">// The @FireEvent annotation communicates the reflection API about several possible outcome events.</span>
        <span class="nd">@FiresEvent</span><span class="o">(</span><span class="n">oneOf</span> <span class="k">=</span> <span class="o">{</span><span class="nc">OrderHadUnavailableItems</span><span class="o">.</span><span class="n">class</span><span class="o">,</span> <span class="nc">ItemsReserved</span><span class="o">.</span><span class="n">class</span><span class="o">})</span>
        <span class="c1">// The @RequiresIngredient annotation communicates the reflection API about the ingredient names that other events</span>
        <span class="c1">// must provide to execute this interaction.</span>
        <span class="nc">ReserveItemsOutcome</span> <span class="n">apply</span><span class="o">(</span><span class="nd">@RequiresIngredient</span><span class="o">(</span><span class="s">&quot;orderId&quot;</span><span class="o">)</span> <span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="nd">@RequiresIngredient</span><span class="o">(</span><span class="s">&quot;items&quot;</span><span class="o">)</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">public</span> <span class="k">final</span> <span class="n">static</span> <span class="nc">Recipe</span> <span class="n">recipe</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Recipe</span><span class="o">(</span><span class="s">&quot;WebshopRecipe&quot;</span><span class="o">)</span>
            <span class="o">.</span><span class="n">withSensoryEvents</span><span class="o">(</span><span class="nc">OrderPlaced</span><span class="o">.</span><span class="n">class</span><span class="o">)</span>
            <span class="o">.</span><span class="n">withInteractions</span><span class="o">(</span><span class="n">of</span><span class="o">(</span><span class="nc">ReserveItems</span><span class="o">.</span><span class="n">class</span><span class="o">));</span>
<span class="o">}</span>
</pre></div></div>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../concepts/" title="Concepts" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Concepts
              </span>
            </div>
          </a>
        
        
          <a href="../use-visualizations/" title="Use Visualizations" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Use Visualizations
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
  </body>
</html>