
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../baker-3-release-notes/">
      
      
        <link rel="next" href="../baker-2/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Migration Guide v3 - Baker</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/ing.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#migration-guide-v3" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Baker" class="md-header__button md-logo" aria-label="Baker" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Baker
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Migration Guide v3
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ing-bank/baker" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Baker" class="md-nav__button md-logo" aria-label="Baker" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Baker
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ing-bank/baker" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart-guide/" class="md-nav__link">
        Quickstart guide
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Cookbook
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Cookbook
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/recipe-dsl/" class="md-nav__link">
        Recipe DSL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/error-handling/" class="md-nav__link">
        Error handling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/visualizations/" class="md-nav__link">
        Visualizations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/fire-sensory-events/" class="md-nav__link">
        Fire events and inquiry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/main-abstractions/" class="md-nav__link">
        Main Abstractions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/execution-semantics/" class="md-nav__link">
        Execution Semantics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/baker-types-and-values/" class="md-nav__link">
        Baker Types and Values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/runtime/" class="md-nav__link">
        The Akka Based Runtime
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/stores/" class="md-nav__link">
        Event Stores and Cluster Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Versions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Versions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../baker-3-release-notes/" class="md-nav__link">
        Release Notes v3
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Migration Guide v3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Migration Guide v3
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#from-2xx-to-300" class="md-nav__link">
    From 2.X.X to 3.0.0
  </a>
  
    <nav class="md-nav" aria-label="From 2.X.X to 3.0.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downtime-required-for-clusters-with-state" class="md-nav__link">
    Downtime required for clusters with state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renamespackage-changes" class="md-nav__link">
    Renames/package changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-and-completablefuture" class="md-nav__link">
    Future and CompletableFuture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-baker-instance" class="md-nav__link">
    Creating a Baker instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-interactions-into-baker" class="md-nav__link">
    Adding Interactions into Baker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firing-events" class="md-nav__link">
    Firing events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#small-changes" class="md-nav__link">
    Small changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-artery-for-akka-remoting" class="md-nav__link">
    About Artery for Akka remoting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency" class="md-nav__link">
    Dependency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../baker-2/" class="md-nav__link">
        Migration Guide v2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../feature-comparison/" class="md-nav__link">
        Feature comparison
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#from-2xx-to-300" class="md-nav__link">
    From 2.X.X to 3.0.0
  </a>
  
    <nav class="md-nav" aria-label="From 2.X.X to 3.0.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downtime-required-for-clusters-with-state" class="md-nav__link">
    Downtime required for clusters with state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renamespackage-changes" class="md-nav__link">
    Renames/package changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-and-completablefuture" class="md-nav__link">
    Future and CompletableFuture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-baker-instance" class="md-nav__link">
    Creating a Baker instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-interactions-into-baker" class="md-nav__link">
    Adding Interactions into Baker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firing-events" class="md-nav__link">
    Firing events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#small-changes" class="md-nav__link">
    Small changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-artery-for-akka-remoting" class="md-nav__link">
    About Artery for Akka remoting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency" class="md-nav__link">
    Dependency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="migration-guide-v3">Migration Guide v3</h1>
<h2 id="from-2xx-to-300">From 2.X.X to 3.0.0</h2>
<p>This guide only describes how to migrate your existing application.
For a full list new features see the <a href="../baker-3-release-notes">release notes</a>.</p>
<p>Summary:</p>
<ul>
<li><em>ALL</em> persisted data from older baker versions <em>IS COMPATIBLE</em> and can be used with <code>3.0.0</code></li>
<li>When running a cluster <em>DOWNTIME IS REQUIRED</em> because of binary incompatible changes in the message protocol.</li>
<li>Code changes are needed to comply to the new Baker interface</li>
<li>No code changes needed to the Recipe (except the removal of the sieve concept)</li>
</ul>
<h3 id="downtime-required-for-clusters-with-state">Downtime required for clusters with state</h3>
<p>In <code>3.0.0</code> some binary incompatible changes where made in the message protocol.</p>
<p>This requires you to bring down the entire cluster (<code>2.x.x</code>) and bring it up again (<code>3.0.0</code>).</p>
<p>A rolling deploy is tested but is NOT recommended.
During the rolling deploy messages regarding handling events will fail.
It is safer to bring the complete cluster down.</p>
<h3 id="renamespackage-changes">Renames/package changes</h3>
<ul>
<li>com.ing.baker.runtime.core -&gt; com.ing.baker.runtime.javadsl/scaladsl/common (depends per object)</li>
<li>com.ing.baker.runtime.java_api -&gt; com.ing.baker.runtime.javadsl</li>
<li>processId -&gt; recipeInstanceId</li>
<li>getProcessId -&gt; GetRecipeInstanceId</li>
<li>RuntimeEvent -&gt; EventInstance</li>
<li>ProcessState -&gt; RecipeInstanceState</li>
</ul>
<h3 id="future-and-completablefuture">Future and CompletableFuture</h3>
<p>The new Java and Scala interfaces now almost always return a Future or CompletableFuture.
It is now up to the user to handle waiting for the completion of this future.
This can either be by blocking directly or by 'correctly' programming with these Futures.
We REALLY advise to invest in programming in a non blocking fashion!</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">//Blocking</span>
<span class="kd">val</span><span class="w"> </span><span class="n">futureStatus</span><span class="p">:</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">SensoryEventStatus</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="n">fireEventAndResolveWhenReceived</span><span class="p">(</span><span class="n">orderId</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">status</span><span class="p">:</span><span class="w"> </span><span class="nc">SensoryEventStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Await</span><span class="p">.</span><span class="n">result</span><span class="p">(</span><span class="n">futureStatus</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">seconds</span><span class="p">)</span>

<span class="c1">//Non Blocking</span>
<span class="kd">val</span><span class="w"> </span><span class="n">futureStatus</span><span class="p">:</span><span class="w"> </span><span class="nc">Future</span><span class="p">[</span><span class="nc">SensoryEventStatus</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baker</span><span class="p">.</span><span class="n">fireEventAndResolveWhenReceived</span><span class="p">(</span><span class="n">orderId</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">)</span>
<span class="n">futureStatus</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">sensoryEventStatus</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="c1">//Code to handle status</span>
<span class="p">})</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">//Blocking</span>
<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">SensoryEventStatus</span><span class="o">&gt;</span><span class="w"> </span><span class="n">futureStatus</span><span class="w"> </span><span class="o">=</span>
<span class="w">                </span><span class="n">baker</span><span class="p">.</span><span class="na">fireEventAndResolveWhenReceived</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span><span class="w"> </span><span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ExampleEvent</span><span class="p">()));</span>
<span class="n">SensoryEventStatus</span><span class="w"> </span><span class="n">sensoryEventStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">futureStatus</span><span class="p">.</span><span class="na">get</span><span class="p">();</span>


<span class="c1">//Non blocking</span>
<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">SensoryEventStatus</span><span class="o">&gt;</span><span class="w"> </span><span class="n">futureStatus</span><span class="w"> </span><span class="o">=</span>
<span class="w">                </span><span class="n">baker</span><span class="p">.</span><span class="na">fireEventAndResolveWhenReceived</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span><span class="w"> </span><span class="n">eventInstance</span><span class="p">));</span>

<span class="n">futureStatus</span><span class="p">.</span><span class="na">thenApply</span><span class="p">(</span><span class="n">sensoryEventStatus</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">//Code to handle status</span>
<span class="p">});</span>
</code></pre></div>
</div>
</div>
<p>Any Exceptions that used to be thrown by Baker are now encapsulated in the Future/CompletableFuture.
For the CompletableFuture the original exception is wrapped in the ExecutionException.
This is how CompletableFuture work and there is no way around it.</p>
<div class="tabbed-set" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">//Blocking</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">baker</span><span class="p">.</span><span class="na">fireEventAndResolveWhenCompleted</span><span class="p">(</span><span class="n">processId</span><span class="p">,</span><span class="w"> </span><span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ExampleEventClass</span><span class="p">())).</span><span class="na">get</span><span class="p">();</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ExecutionException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getCause</span><span class="p">()</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BakerException</span><span class="p">.</span><span class="na">NoSuchProcessException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//Code to handle NoSuchProcessException</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//Code to handle other Exceptions</span>
<span class="p">}</span>


<span class="c1">//Non blocking</span>
<span class="n">baker</span><span class="p">.</span><span class="na">fireEventAndResolveWhenCompleted</span><span class="p">(</span><span class="n">processId</span><span class="p">,</span><span class="w"> </span><span class="n">EventInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ExampleEventClass</span><span class="p">()))</span>
<span class="w">        </span><span class="p">.</span><span class="na">exceptionally</span><span class="p">(</span><span class="n">exception</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">exception</span><span class="p">.</span><span class="na">getCause</span><span class="p">()</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BakerException</span><span class="p">.</span><span class="na">NoSuchProcessException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">//Decide on what to return on NoSuchProcessException</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">//Decide on what to return on other Exceptions</span>
<span class="w">        </span><span class="p">});</span>
</code></pre></div>
</div>
</div>
<h3 id="creating-a-baker-instance">Creating a Baker instance</h3>
<p>A Baker instance is now created not with a constructor but via a static method.</p>
<p>For Java the JBaker is gone and you now create a Baker under the javadsl package.</p>
<div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">ing</span><span class="p">.</span><span class="nn">baker</span><span class="p">.</span><span class="nn">runtime</span><span class="p">.</span><span class="nn">scaladsl</span><span class="p">.</span><span class="n">*</span><span class="err">;</span>
<span class="p">......</span>
<span class="kd">val</span><span class="w"> </span><span class="n">actorSystem</span><span class="p">:</span><span class="w"> </span><span class="nc">ActorSystem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ActorSystem</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">config</span><span class="p">:</span><span class="w"> </span><span class="nc">Config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ConfigFactory</span><span class="p">.</span><span class="n">load</span><span class="p">()</span>
<span class="kd">val</span><span class="w"> </span><span class="n">baker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Baker</span><span class="p">.</span><span class="n">akka</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">actorSystem</span><span class="p">);</span>
</code></pre></div>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">com.ing.baker.runtime.javadsl.*</span><span class="p">;</span>
<span class="p">......</span>
<span class="n">ActorSystem</span><span class="w"> </span><span class="n">actorSystem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActorSystem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="p">);</span>
<span class="n">Config</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConfigFactory</span><span class="p">.</span><span class="na">load</span><span class="p">();</span>
<span class="n">Baker</span><span class="w"> </span><span class="n">baker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Baker</span><span class="p">.</span><span class="na">akka</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">actorSystem</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
<p>See the <a href="../../reference/runtime">runtime reference</a> for more details</p>
<h3 id="adding-interactions-into-baker">Adding Interactions into Baker</h3>
<p>When adding InteractionInstances formerly known as InteractionImplementations to Baker you now need to give a real InteractionInstance object.</p>
<div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kd">val</span><span class="w"> </span><span class="n">reserveItemsInstance</span><span class="p">:</span><span class="w"> </span><span class="nc">InteractionInstance</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nc">InteractionInstance</span><span class="p">.</span><span class="n">unsafeFrom</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="nc">ReserveItemsInstance</span><span class="p">)</span>
<span class="n">baker</span><span class="p">.</span><span class="n">addInteractionInstance</span><span class="p">(</span><span class="n">reserveItemsInstance</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">InteractionInstance</span><span class="w"> </span><span class="n">reserveItemsInstance</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">InteractionInstance</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ReserveItemsInstance</span><span class="p">());</span>
<span class="n">baker</span><span class="p">.</span><span class="na">addInteractionInstance</span><span class="p">(</span><span class="n">reserveItemsInstance</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h3 id="firing-events">Firing events</h3>
<p>The processEvent has been completely rewritten and is now named FireEvent.
See the <a href="../baker-3-release-notes/#firing-events-into-baker">release note</a> or <a href="../../development-life-cycle/bake-fire-events-and-inquiry/#fire-events">fire event section</a> for more details</p>
<h3 id="small-changes">Small changes</h3>
<ul>
<li>dropped .withSieves on the recipe, add these with .withInteractionInstances</li>
<li>removed support in the interface for UUID, for interaction interfaces a UUID is still supported for backwards compatability reasons.</li>
</ul>
<h3 id="about-artery-for-akka-remoting">About Artery for Akka remoting</h3>
<p>Akka has released a new remoting protocol called <a href="https://doc.akka.io/docs/akka/current/remoting-artery.html">Artery</a>
This is very interesting for Baker users that have Akka cluster.
We have successfully migrated to this from the old remoting and see stability and performance gains.</p>
<h3 id="dependency">Dependency</h3>
<p>We have noticed that when using Baker in a maven project the dependencies are not always take over correctly.
If you have the following dependencies in your project please upgrade them:
* org.typelevel.cats-core_2.12 1.5.0
* org.typelevel.cats-effect_2.12 1.2.0
* All Akka dependencies to 2.5.22 (should work with other 2.5.X versions but 2.5.22 is the one we tested).</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>